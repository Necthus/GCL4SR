Namespace(model_name='GCL4SR', data_name='fk2', data_dir='./datasets/fk2/', output_dir='output/', do_eval=False, no_cuda=False, gpu_id='3', lr=0.001, lr_dc=0.7, lr_dc_step=5, weight_decay=5e-05, adam_beta1=0.9, adam_beta2=0.999, num_hidden_layers=2, num_attention_heads=2, hidden_act='gelu', attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, epochs=200, batch_size=1024, max_seq_length=15, hidden_size=64, seed=2022, log_freq=1, patience=10, gnn_dropout_prob=0.5, use_renorm=True, use_scale=False, fast_run=True, sample_depth=2, sample_width=20, lam1=1, lam2=0.1, cuda_condition=True, sample_size=[20, 20], data_file='./datasets/fk2/fk2.txt', x_domain_size=29208, item_size=64090, user_size=5689, log_file='output/GCL4SR-fk2-[20, 20].txt')
Data(x=[64089, 1], edge_index=[2, 660604], edge_attr=[660604, 1])
n_sample-[20, 20]-hidden_size-64
{'epoch': 0, 'joint_loss_avg': '26.2093', 'main_loss_avg': '10.9425', 'gcl_loss_avg': '15.1644', 'mmd_loss_avg': '1.0246'}
{'Epoch': 0, 'X': {'MRR': 0.003644671826490008, 'NDCG5': 0.0051492592007921206, 'NDCG10': 0.005590855478995048, 'HR1': 0.0027548209366391185, 'HR5': 0.004591368227731864, 'HR10': 0.005509641873278237, 'NUM': 1089}, 'Y': {'MRR': 0.0012360211889346673, 'NDCG5': 0.002370374424467065, 'NDCG10': 0.002370374424467065, 'HR1': 0.0005885815185403178, 'HR5': 0.002942907592701589, 'HR10': 0.002942907592701589, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 1, 'joint_loss_avg': '24.6466', 'main_loss_avg': '9.9451', 'gcl_loss_avg': '14.6931', 'mmd_loss_avg': '0.0839'}
{'Epoch': 1, 'X': {'MRR': 0.0029449226418923396, 'NDCG5': 0.0046500954911047835, 'NDCG10': 0.005091691769307711, 'HR1': 0.0009182736455463728, 'HR5': 0.005509641873278237, 'HR10': 0.006427915518824609, 'NUM': 1089}, 'Y': {'MRR': 0.0008828722778104767, 'NDCG5': 0.0013848936242000006, 'NDCG10': 0.0013848936242000006, 'HR1': 0.0005885815185403178, 'HR5': 0.0011771630370806356, 'HR10': 0.0011771630370806356, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 2, 'joint_loss_avg': '22.7946', 'main_loss_avg': '9.4800', 'gcl_loss_avg': '13.2845', 'mmd_loss_avg': '0.3009'}
{'Epoch': 2, 'X': {'MRR': 0.005249526582224514, 'NDCG5': 0.00653210525120289, 'NDCG10': 0.008579998693514845, 'HR1': 0.0036730945821854912, 'HR5': 0.005509641873278237, 'HR10': 0.010101010101010102, 'NUM': 1089}, 'Y': {'MRR': 0.0008828722778104767, 'NDCG5': 0.0013848936242000006, 'NDCG10': 0.0013848936242000006, 'HR1': 0.0005885815185403178, 'HR5': 0.0011771630370806356, 'HR10': 0.0011771630370806356, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 3, 'joint_loss_avg': '21.8170', 'main_loss_avg': '9.3407', 'gcl_loss_avg': '12.4647', 'mmd_loss_avg': '0.1161'}
{'Epoch': 3, 'X': {'MRR': 0.0073724546693399295, 'NDCG5': 0.010088206027394008, 'NDCG10': 0.013524976307880007, 'HR1': 0.0027548209366391185, 'HR5': 0.011019283746556474, 'HR10': 0.018365472910927456, 'NUM': 1089}, 'Y': {'MRR': 0.0005885815185403178, 'NDCG5': 0.000849143637957012, 'NDCG10': 0.000849143637957012, 'HR1': 0.0005885815185403178, 'HR5': 0.0005885815185403178, 'HR10': 0.0005885815185403178, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 4, 'joint_loss_avg': '20.9244', 'main_loss_avg': '9.1701', 'gcl_loss_avg': '11.7505', 'mmd_loss_avg': '0.0371'}
{'Epoch': 4, 'X': {'MRR': 0.007659671468211412, 'NDCG5': 0.011321155940161769, 'NDCG10': 0.01475444426925287, 'HR1': 0.0027548209366391185, 'HR5': 0.012855831037649219, 'HR10': 0.020202020202020204, 'NUM': 1089}, 'Y': {'MRR': 0.001569550716107514, 'NDCG5': 0.0025474309138710355, 'NDCG10': 0.0025474309138710355, 'HR1': 0.0011771630370806356, 'HR5': 0.002354326074161271, 'HR10': 0.002354326074161271, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 5, 'joint_loss_avg': '20.5211', 'main_loss_avg': '8.9012', 'gcl_loss_avg': '11.6178', 'mmd_loss_avg': '0.0212'}
{'Epoch': 5, 'X': {'MRR': 0.010295261944103299, 'NDCG5': 0.014294084022671887, 'NDCG10': 0.019915041058825803, 'HR1': 0.0036730945821854912, 'HR5': 0.015610651974288337, 'HR10': 0.027548209366391185, 'NUM': 1089}, 'Y': {'MRR': 0.002379550996384428, 'NDCG5': 0.004360402451638075, 'NDCG10': 0.00464345033095708, 'HR1': 0.0011771630370806356, 'HR5': 0.00529723366686286, 'HR10': 0.005885815185403178, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 6, 'joint_loss_avg': '20.2483', 'main_loss_avg': '8.6733', 'gcl_loss_avg': '11.5730', 'mmd_loss_avg': '0.0202'}
{'Epoch': 6, 'X': {'MRR': 0.010589576597922085, 'NDCG5': 0.01557415021145273, 'NDCG10': 0.0214495843976068, 'HR1': 0.0027548209366391185, 'HR5': 0.018365472910927456, 'HR10': 0.031221303948576674, 'NUM': 1089}, 'Y': {'MRR': 0.00364920541494997, 'NDCG5': 0.0059525524619920426, 'NDCG10': 0.0062550235287193836, 'HR1': 0.002354326074161271, 'HR5': 0.005885815185403178, 'HR10': 0.006474396703943496, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 7, 'joint_loss_avg': '19.9620', 'main_loss_avg': '8.4098', 'gcl_loss_avg': '11.5500', 'mmd_loss_avg': '0.0218'}
{'Epoch': 7, 'X': {'MRR': 0.013053602766094984, 'NDCG5': 0.01897081404428487, 'NDCG10': 0.02361180846515683, 'HR1': 0.006427915518824609, 'HR5': 0.020202020202020204, 'HR10': 0.030303030303030304, 'NUM': 1089}, 'Y': {'MRR': 0.003577267673795043, 'NDCG5': 0.005645711762360058, 'NDCG10': 0.006146787026237339, 'HR1': 0.002354326074161271, 'HR5': 0.00529723366686286, 'HR10': 0.006474396703943496, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 8, 'joint_loss_avg': '19.6748', 'main_loss_avg': '8.1420', 'gcl_loss_avg': '11.5309', 'mmd_loss_avg': '0.0194'}
{'Epoch': 8, 'X': {'MRR': 0.012996709308085096, 'NDCG5': 0.018474009355342765, 'NDCG10': 0.024633455432196468, 'HR1': 0.006427915518824609, 'HR5': 0.020202020202020204, 'HR10': 0.03305785123966942, 'NUM': 1089}, 'Y': {'MRR': 0.00524398105328064, 'NDCG5': 0.008621220589798133, 'NDCG10': 0.009206739535844478, 'HR1': 0.003531489111241907, 'HR5': 0.008828722778104767, 'HR10': 0.010005885815185403, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 9, 'joint_loss_avg': '19.3737', 'main_loss_avg': '7.8507', 'gcl_loss_avg': '11.5209', 'mmd_loss_avg': '0.0209'}
{'Epoch': 9, 'X': {'MRR': 0.015352771559754133, 'NDCG5': 0.021885684910993, 'NDCG10': 0.02871434803892777, 'HR1': 0.0073461891643709825, 'HR5': 0.02295684113865932, 'HR10': 0.03764921946740129, 'NUM': 1089}, 'Y': {'MRR': 0.005459794276745424, 'NDCG5': 0.008833517877656525, 'NDCG10': 0.009664494381927855, 'HR1': 0.002942907592701589, 'HR5': 0.008828722778104767, 'HR10': 0.01059446733372572, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 10, 'joint_loss_avg': '19.0737', 'main_loss_avg': '7.5632', 'gcl_loss_avg': '11.5083', 'mmd_loss_avg': '0.0211'}
{'Epoch': 10, 'X': {'MRR': 0.01844164151326685, 'NDCG5': 0.027066366797078918, 'NDCG10': 0.03425885661005875, 'HR1': 0.009182736455463728, 'HR5': 0.027548209366391185, 'HR10': 0.04315886134067952, 'NUM': 1089}, 'Y': {'MRR': 0.006333791118958864, 'NDCG5': 0.010494592494354327, 'NDCG10': 0.011052681266733963, 'HR1': 0.003531489111241907, 'HR5': 0.01059446733372572, 'HR10': 0.011771630370806356, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 11, 'joint_loss_avg': '18.8151', 'main_loss_avg': '7.3128', 'gcl_loss_avg': '11.5002', 'mmd_loss_avg': '0.0201'}
{'Epoch': 11, 'X': {'MRR': 0.01842827779061777, 'NDCG5': 0.026569562108136813, 'NDCG10': 0.032602582510147145, 'HR1': 0.010101010101010102, 'HR5': 0.02662993572084481, 'HR10': 0.03948576675849403, 'NUM': 1089}, 'Y': {'MRR': 0.006460382858263965, 'NDCG5': 0.010324548767416581, 'NDCG10': 0.011155525271687911, 'HR1': 0.004120070629782225, 'HR5': 0.010005885815185403, 'HR10': 0.011771630370806356, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 12, 'joint_loss_avg': '18.6122', 'main_loss_avg': '7.1177', 'gcl_loss_avg': '11.4924', 'mmd_loss_avg': '0.0200'}
{'Epoch': 12, 'X': {'MRR': 0.018347862593122675, 'NDCG5': 0.027975248924797705, 'NDCG10': 0.033620560605227195, 'HR1': 0.008264462809917356, 'HR5': 0.030303030303030304, 'HR10': 0.04224058769513315, 'NUM': 1089}, 'Y': {'MRR': 0.0065430645477732, 'NDCG5': 0.010309448819041585, 'NDCG10': 0.011450140938739256, 'HR1': 0.004120070629782225, 'HR5': 0.010005885815185403, 'HR10': 0.012360211889346674, 'NUM': 1699}}
EarlyStopping counter: 2 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 13, 'joint_loss_avg': '18.4100', 'main_loss_avg': '6.9217', 'gcl_loss_avg': '11.4863', 'mmd_loss_avg': '0.0203'}
{'Epoch': 13, 'X': {'MRR': 0.020596122309782975, 'NDCG5': 0.030791851065890396, 'NDCG10': 0.035469009493468096, 'HR1': 0.012855831037649219, 'HR5': 0.030303030303030304, 'HR10': 0.04040404040404041, 'NUM': 1089}, 'Y': {'MRR': 0.006317441632332744, 'NDCG5': 0.010324548767416581, 'NDCG10': 0.011231961967598604, 'HR1': 0.003531489111241907, 'HR5': 0.01059446733372572, 'HR10': 0.012360211889346674, 'NUM': 1699}}
EarlyStopping counter: 3 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 14, 'joint_loss_avg': '18.1810', 'main_loss_avg': '6.6972', 'gcl_loss_avg': '11.4819', 'mmd_loss_avg': '0.0193'}
{'Epoch': 14, 'X': {'MRR': 0.01981061777488612, 'NDCG5': 0.030872031676186087, 'NDCG10': 0.03612015007535709, 'HR1': 0.010101010101010102, 'HR5': 0.03305785123966942, 'HR10': 0.04499540863177227, 'NUM': 1089}, 'Y': {'MRR': 0.007622130665097116, 'NDCG5': 0.011583164275977104, 'NDCG10': 0.013026327462402116, 'HR1': 0.00529723366686286, 'HR5': 0.01059446733372572, 'HR10': 0.01353737492642731, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 15, 'joint_loss_avg': '17.9570', 'main_loss_avg': '6.4814', 'gcl_loss_avg': '11.4738', 'mmd_loss_avg': '0.0186'}
{'Epoch': 15, 'X': {'MRR': 0.020998811666855747, 'NDCG5': 0.03140333544292364, 'NDCG10': 0.03677852692705591, 'HR1': 0.011937557392102846, 'HR5': 0.031221303948576674, 'HR10': 0.04315886134067952, 'NUM': 1089}, 'Y': {'MRR': 0.007028644300568962, 'NDCG5': 0.011650576831943323, 'NDCG10': 0.012220922891792158, 'HR1': 0.004120070629782225, 'HR5': 0.011771630370806356, 'HR10': 0.012948793407886992, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 16, 'joint_loss_avg': '17.7957', 'main_loss_avg': '6.3225', 'gcl_loss_avg': '11.4715', 'mmd_loss_avg': '0.0180'}
{'Epoch': 16, 'X': {'MRR': 0.02137689024336245, 'NDCG5': 0.031479480774045374, 'NDCG10': 0.03836399108695373, 'HR1': 0.011937557392102846, 'HR5': 0.030303030303030304, 'HR10': 0.04499540863177227, 'NUM': 1089}, 'Y': {'MRR': 0.006740659771854594, 'NDCG5': 0.010569017812786772, 'NDCG10': 0.012275805691122453, 'HR1': 0.003531489111241907, 'HR5': 0.01059446733372572, 'HR10': 0.014125956444967627, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 17, 'joint_loss_avg': '17.6778', 'main_loss_avg': '6.2085', 'gcl_loss_avg': '11.4674', 'mmd_loss_avg': '0.0182'}
{'Epoch': 17, 'X': {'MRR': 0.020769403698149353, 'NDCG5': 0.03256253454917013, 'NDCG10': 0.03744215479728833, 'HR1': 0.011019283746556474, 'HR5': 0.03305785123966942, 'HR10': 0.0440771349862259, 'NUM': 1089}, 'Y': {'MRR': 0.006436559320608762, 'NDCG5': 0.010690255026721827, 'NDCG10': 0.011558821852087177, 'HR1': 0.003531489111241907, 'HR5': 0.011183048852266038, 'HR10': 0.012948793407886992, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 18, 'joint_loss_avg': '17.5278', 'main_loss_avg': '6.0611', 'gcl_loss_avg': '11.4649', 'mmd_loss_avg': '0.0188'}
{'Epoch': 18, 'X': {'MRR': 0.02188237484380734, 'NDCG5': 0.03231768848774455, 'NDCG10': 0.03874160205673175, 'HR1': 0.012855831037649219, 'HR5': 0.031221303948576674, 'HR10': 0.04499540863177227, 'NUM': 1089}, 'Y': {'MRR': 0.006700720311667929, 'NDCG5': 0.01047293959389729, 'NDCG10': 0.01223374673324715, 'HR1': 0.003531489111241907, 'HR5': 0.01059446733372572, 'HR10': 0.014125956444967627, 'NUM': 1699}}
EarlyStopping counter: 2 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 19, 'joint_loss_avg': '17.4075', 'main_loss_avg': '5.9434', 'gcl_loss_avg': '11.4622', 'mmd_loss_avg': '0.0187'}
{'Epoch': 19, 'X': {'MRR': 0.022028066311812863, 'NDCG5': 0.03323515253450701, 'NDCG10': 0.03925036198541192, 'HR1': 0.011937557392102846, 'HR5': 0.03305785123966942, 'HR10': 0.04591368227731864, 'NUM': 1089}, 'Y': {'MRR': 0.006249474480787018, 'NDCG5': 0.010482998640567861, 'NDCG10': 0.011336392579735701, 'HR1': 0.003531489111241907, 'HR5': 0.011183048852266038, 'HR10': 0.012948793407886992, 'NUM': 1699}}
EarlyStopping counter: 3 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 20, 'joint_loss_avg': '17.2557', 'main_loss_avg': '5.7943', 'gcl_loss_avg': '11.4596', 'mmd_loss_avg': '0.0186'}
{'Epoch': 20, 'X': {'MRR': 0.021565593879643456, 'NDCG5': 0.033498768579153536, 'NDCG10': 0.03973356808915474, 'HR1': 0.011937557392102846, 'HR5': 0.03489439853076217, 'HR10': 0.048668503213957756, 'NUM': 1089}, 'Y': {'MRR': 0.00674601704619362, 'NDCG5': 0.010774279581440659, 'NDCG10': 0.012720177576748608, 'HR1': 0.003531489111241907, 'HR5': 0.011771630370806356, 'HR10': 0.015891701000588582, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 21, 'joint_loss_avg': '17.1917', 'main_loss_avg': '5.7322', 'gcl_loss_avg': '11.4577', 'mmd_loss_avg': '0.0174'}
{'Epoch': 21, 'X': {'MRR': 0.022543527067233022, 'NDCG5': 0.03479145286056733, 'NDCG10': 0.03965194993934652, 'HR1': 0.012855831037649219, 'HR5': 0.03397612488521579, 'HR10': 0.04499540863177227, 'NUM': 1089}, 'Y': {'MRR': 0.007179293141623926, 'NDCG5': 0.010696807978803869, 'NDCG10': 0.01302796117800256, 'HR1': 0.004120070629782225, 'HR5': 0.01059446733372572, 'HR10': 0.015303119482048263, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 22, 'joint_loss_avg': '17.0864', 'main_loss_avg': '5.6292', 'gcl_loss_avg': '11.4555', 'mmd_loss_avg': '0.0172'}
{'Epoch': 22, 'X': {'MRR': 0.02189573167129478, 'NDCG5': 0.033895152427210945, 'NDCG10': 0.03962311344326286, 'HR1': 0.012855831037649219, 'HR5': 0.03489439853076217, 'HR10': 0.047750229568411386, 'NUM': 1089}, 'Y': {'MRR': 0.0062616198137092766, 'NDCG5': 0.00971833936771387, 'NDCG10': 0.012263269650260013, 'HR1': 0.003531489111241907, 'HR5': 0.01059446733372572, 'HR10': 0.015891701000588582, 'NUM': 1699}}
EarlyStopping counter: 2 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 23, 'joint_loss_avg': '16.9883', 'main_loss_avg': '5.5329', 'gcl_loss_avg': '11.4536', 'mmd_loss_avg': '0.0175'}
{'Epoch': 23, 'X': {'MRR': 0.02152281067570323, 'NDCG5': 0.03461324503957208, 'NDCG10': 0.03907179179824898, 'HR1': 0.011019283746556474, 'HR5': 0.03673094582185491, 'HR10': 0.046831955922865015, 'NUM': 1089}, 'Y': {'MRR': 0.00688219961321786, 'NDCG5': 0.011989129478702917, 'NDCG10': 0.013008550032696872, 'HR1': 0.003531489111241907, 'HR5': 0.01353737492642731, 'HR10': 0.015891701000588582, 'NUM': 1699}}
EarlyStopping counter: 3 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 24, 'joint_loss_avg': '16.9217', 'main_loss_avg': '5.4700', 'gcl_loss_avg': '11.4500', 'mmd_loss_avg': '0.0174'}
{'Epoch': 24, 'X': {'MRR': 0.02109734719927557, 'NDCG5': 0.03199984360099401, 'NDCG10': 0.038854260992626996, 'HR1': 0.009182736455463728, 'HR5': 0.03305785123966942, 'HR10': 0.047750229568411386, 'NUM': 1089}, 'Y': {'MRR': 0.006117043639115445, 'NDCG5': 0.010523717394372618, 'NDCG10': 0.011902622523596269, 'HR1': 0.002942907592701589, 'HR5': 0.012360211889346674, 'HR10': 0.015303119482048263, 'NUM': 1699}}
EarlyStopping counter: 4 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 25, 'joint_loss_avg': '16.8177', 'main_loss_avg': '5.3678', 'gcl_loss_avg': '11.4482', 'mmd_loss_avg': '0.0173'}
{'Epoch': 25, 'X': {'MRR': 0.021631207788232572, 'NDCG5': 0.03327512163498925, 'NDCG10': 0.03984998849712052, 'HR1': 0.011937557392102846, 'HR5': 0.03397612488521579, 'HR10': 0.048668503213957756, 'NUM': 1089}, 'Y': {'MRR': 0.006153713201976886, 'NDCG5': 0.009522676835346366, 'NDCG10': 0.012300886037408159, 'HR1': 0.002942907592701589, 'HR5': 0.01059446733372572, 'HR10': 0.0164802825191289, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 26, 'joint_loss_avg': '16.7552', 'main_loss_avg': '5.3059', 'gcl_loss_avg': '11.4476', 'mmd_loss_avg': '0.0168'}
{'Epoch': 26, 'X': {'MRR': 0.02174873896636981, 'NDCG5': 0.032638679880291864, 'NDCG10': 0.03901435676846771, 'HR1': 0.011019283746556474, 'HR5': 0.03213957759412305, 'HR10': 0.04591368227731864, 'NUM': 1089}, 'Y': {'MRR': 0.006155369383739013, 'NDCG5': 0.01004683296780289, 'NDCG10': 0.011646759729072993, 'HR1': 0.003531489111241907, 'HR5': 0.011183048852266038, 'HR10': 0.014714537963507945, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 27, 'joint_loss_avg': '16.6868', 'main_loss_avg': '5.2376', 'gcl_loss_avg': '11.4475', 'mmd_loss_avg': '0.0172'}
{'Epoch': 27, 'X': {'MRR': 0.021180157715970382, 'NDCG5': 0.032704566139525874, 'NDCG10': 0.03903625841202394, 'HR1': 0.011019283746556474, 'HR5': 0.03397612488521579, 'HR10': 0.047750229568411386, 'NUM': 1089}, 'Y': {'MRR': 0.005462815910137865, 'NDCG5': 0.009763639212838862, 'NDCG10': 0.011133281302081494, 'HR1': 0.0017657445556209534, 'HR5': 0.012360211889346674, 'HR10': 0.015303119482048263, 'NUM': 1699}}
EarlyStopping counter: 2 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 28, 'joint_loss_avg': '16.6383', 'main_loss_avg': '5.1909', 'gcl_loss_avg': '11.4456', 'mmd_loss_avg': '0.0173'}
{'Epoch': 28, 'X': {'MRR': 0.022511383117443717, 'NDCG5': 0.03479931740785458, 'NDCG10': 0.03992015444560745, 'HR1': 0.011019283746556474, 'HR5': 0.03489439853076217, 'HR10': 0.04591368227731864, 'NUM': 1089}, 'Y': {'MRR': 0.005938600670796079, 'NDCG5': 0.009829057724594165, 'NDCG10': 0.011481747693155795, 'HR1': 0.002942907592701589, 'HR5': 0.011183048852266038, 'HR10': 0.014714537963507945, 'NUM': 1699}}
EarlyStopping counter: 3 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 29, 'joint_loss_avg': '16.5699', 'main_loss_avg': '5.1236', 'gcl_loss_avg': '11.4446', 'mmd_loss_avg': '0.0169'}
{'Epoch': 29, 'X': {'MRR': 0.022953214133735925, 'NDCG5': 0.03582431396717735, 'NDCG10': 0.039245232924909425, 'HR1': 0.011937557392102846, 'HR5': 0.03581267217630854, 'HR10': 0.04315886134067952, 'NUM': 1089}, 'Y': {'MRR': 0.006766118258172405, 'NDCG5': 0.010371820473303381, 'NDCG10': 0.013238645009985199, 'HR1': 0.003531489111241907, 'HR5': 0.011183048852266038, 'HR10': 0.017068864037669218, 'NUM': 1699}}
EarlyStopping counter: 4 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 30, 'joint_loss_avg': '16.5337', 'main_loss_avg': '5.0880', 'gcl_loss_avg': '11.4441', 'mmd_loss_avg': '0.0160'}
{'Epoch': 30, 'X': {'MRR': 0.021661760849088666, 'NDCG5': 0.033911598893541874, 'NDCG10': 0.03930591354701312, 'HR1': 0.011019283746556474, 'HR5': 0.03489439853076217, 'HR10': 0.046831955922865015, 'NUM': 1089}, 'Y': {'MRR': 0.006153713201976885, 'NDCG5': 0.009468852177377533, 'NDCG10': 0.012561711084876, 'HR1': 0.002354326074161271, 'HR5': 0.01059446733372572, 'HR10': 0.017068864037669218, 'NUM': 1699}}
EarlyStopping counter: 5 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 31, 'joint_loss_avg': '16.4877', 'main_loss_avg': '5.0434', 'gcl_loss_avg': '11.4426', 'mmd_loss_avg': '0.0164'}
{'Epoch': 31, 'X': {'MRR': 0.022442196990487377, 'NDCG5': 0.03635014681681278, 'NDCG10': 0.040135015163210684, 'HR1': 0.010101010101010102, 'HR5': 0.03856749311294766, 'HR10': 0.046831955922865015, 'NUM': 1089}, 'Y': {'MRR': 0.005730962190644357, 'NDCG5': 0.00913836395978843, 'NDCG10': 0.011653710907498924, 'HR1': 0.002942907592701589, 'HR5': 0.01059446733372572, 'HR10': 0.015891701000588582, 'NUM': 1699}}
EarlyStopping counter: 6 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 32, 'joint_loss_avg': '16.4681', 'main_loss_avg': '5.0258', 'gcl_loss_avg': '11.4406', 'mmd_loss_avg': '0.0163'}
{'Epoch': 32, 'X': {'MRR': 0.02119464047838703, 'NDCG5': 0.032991058454277744, 'NDCG10': 0.0392607450551828, 'HR1': 0.009182736455463728, 'HR5': 0.03489439853076217, 'HR10': 0.048668503213957756, 'NUM': 1089}, 'Y': {'MRR': 0.005789374447408585, 'NDCG5': 0.009648954950985849, 'NDCG10': 0.011348498280622525, 'HR1': 0.002354326074161271, 'HR5': 0.011183048852266038, 'HR10': 0.014714537963507945, 'NUM': 1699}}
EarlyStopping counter: 7 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 33, 'joint_loss_avg': '16.4143', 'main_loss_avg': '4.9721', 'gcl_loss_avg': '11.4406', 'mmd_loss_avg': '0.0164'}
{'Epoch': 33, 'X': {'MRR': 0.021832787914055123, 'NDCG5': 0.035201888650355194, 'NDCG10': 0.039757415572718, 'HR1': 0.010101010101010102, 'HR5': 0.03764921946740129, 'HR10': 0.047750229568411386, 'NUM': 1089}, 'Y': {'MRR': 0.0051713426198417385, 'NDCG5': 0.008300814175617881, 'NDCG10': 0.010884590832980698, 'HR1': 0.0017657445556209534, 'HR5': 0.010005885815185403, 'HR10': 0.015303119482048263, 'NUM': 1699}}
EarlyStopping counter: 8 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 34, 'joint_loss_avg': '16.3787', 'main_loss_avg': '4.9366', 'gcl_loss_avg': '11.4405', 'mmd_loss_avg': '0.0158'}
{'Epoch': 34, 'X': {'MRR': 0.021890269204318785, 'NDCG5': 0.03442409717320325, 'NDCG10': 0.039438821220064584, 'HR1': 0.011019283746556474, 'HR5': 0.03581267217630854, 'HR10': 0.046831955922865015, 'NUM': 1089}, 'Y': {'MRR': 0.006206732251464445, 'NDCG5': 0.01017966403552441, 'NDCG10': 0.012370122481611052, 'HR1': 0.002942907592701589, 'HR5': 0.011771630370806356, 'HR10': 0.0164802825191289, 'NUM': 1699}}
EarlyStopping counter: 9 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 35, 'joint_loss_avg': '16.3277', 'main_loss_avg': '4.8876', 'gcl_loss_avg': '11.4385', 'mmd_loss_avg': '0.0158'}
{'Epoch': 35, 'X': {'MRR': 0.022529973597466706, 'NDCG5': 0.03489426733163715, 'NDCG10': 0.04042508540327418, 'HR1': 0.010101010101010102, 'HR5': 0.03581267217630854, 'HR10': 0.047750229568411386, 'NUM': 1089}, 'Y': {'MRR': 0.006360848621001651, 'NDCG5': 0.009194183235257345, 'NDCG10': 0.012309459577652322, 'HR1': 0.003531489111241907, 'HR5': 0.009417304296645085, 'HR10': 0.015891701000588582, 'NUM': 1699}}
EarlyStopping counter: 10 out of 10
Early stopping
---------------Change to test_rating_matrix!-------------------
{'Epoch': 0, 'X': {'MRR': 0.014773716096967513, 'NDCG5': 0.023406643001990423, 'NDCG10': 0.02837815010059374, 'HR1': 0.006616257088846881, 'HR5': 0.026465028355387523, 'HR10': 0.036862003780718335, 'NUM': 1058}, 'Y': {'MRR': 0.005091982533653721, 'NDCG5': 0.008104372259432587, 'NDCG10': 0.009117366667501172, 'HR1': 0.0032555615843733042, 'HR5': 0.008138903960933261, 'HR10': 0.010309278350515464, 'NUM': 1843}}
GCL4SR-fk2-[20, 20]
{'Epoch': 0, 'X': {'MRR': 0.014773716096967513, 'NDCG5': 0.023406643001990423, 'NDCG10': 0.02837815010059374, 'HR1': 0.006616257088846881, 'HR5': 0.026465028355387523, 'HR10': 0.036862003780718335, 'NUM': 1058}, 'Y': {'MRR': 0.005091982533653721, 'NDCG5': 0.008104372259432587, 'NDCG10': 0.009117366667501172, 'HR1': 0.0032555615843733042, 'HR5': 0.008138903960933261, 'HR10': 0.010309278350515464, 'NUM': 1843}}
