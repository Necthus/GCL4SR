Namespace(model_name='GCL4SR', data_name='fk', data_dir='./datasets/fk/', output_dir='output/', do_eval=False, no_cuda=False, gpu_id='3', lr=0.001, lr_dc=0.7, lr_dc_step=5, weight_decay=5e-05, adam_beta1=0.9, adam_beta2=0.999, num_hidden_layers=2, num_attention_heads=2, hidden_act='gelu', attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, epochs=200, batch_size=1024, max_seq_length=15, hidden_size=128, seed=2022, log_freq=1, patience=10, gnn_dropout_prob=0.5, use_renorm=True, use_scale=False, fast_run=True, sample_depth=2, sample_width=20, lam1=1, lam2=0.1, cuda_condition=True, sample_size=[20, 20], data_file='./datasets/fk/fk.txt', x_domain_size=29208, item_size=64090, user_size=16573, log_file='output/GCL4SR-fk-[20, 20].txt')
n_sample-[20, 20]-hidden_size-128
{'epoch': 0, 'joint_loss_avg': '25.7990', 'main_loss_avg': '10.6106', 'gcl_loss_avg': '15.1493', 'mmd_loss_avg': '0.3911'}
{'Epoch': 0, 'X': {'MRR': 0.003801867047289183, 'NDCG5': 0.005346271614448206, 'NDCG10': 0.006162997138063147, 'HR1': 0.0018365472910927456, 'HR5': 0.005509641873278237, 'HR10': 0.0073461891643709825, 'NUM': 1089}, 'Y': {'MRR': 0.0011771630370806356, 'NDCG5': 0.0019206436104429888, 'NDCG10': 0.0019206436104429888, 'HR1': 0.0005885815185403178, 'HR5': 0.0017657445556209534, 'HR10': 0.0017657445556209534, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-128
{'epoch': 1, 'joint_loss_avg': '23.2688', 'main_loss_avg': '9.4976', 'gcl_loss_avg': '13.7561', 'mmd_loss_avg': '0.1518'}
{'Epoch': 1, 'X': {'MRR': 0.003826590323916527, 'NDCG5': 0.005916827109911577, 'NDCG10': 0.007189600615060719, 'HR1': 0.0018365472910927456, 'HR5': 0.006427915518824609, 'HR10': 0.009182736455463728, 'NUM': 1089}, 'Y': {'MRR': 0.0009809691975671963, 'NDCG5': 0.001698287275914024, 'NDCG10': 0.001698287275914024, 'HR1': 0.0005885815185403178, 'HR5': 0.0017657445556209534, 'HR10': 0.0017657445556209534, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-128
{'epoch': 2, 'joint_loss_avg': '22.0952', 'main_loss_avg': '9.2852', 'gcl_loss_avg': '12.7995', 'mmd_loss_avg': '0.1046'}
{'Epoch': 2, 'X': {'MRR': 0.007390042617315344, 'NDCG5': 0.011710428116543563, 'NDCG10': 0.012999052944446613, 'HR1': 0.0018365472910927456, 'HR5': 0.012855831037649219, 'HR10': 0.015610651974288337, 'NUM': 1089}, 'Y': {'MRR': 0.0020600353148911123, 'NDCG5': 0.0030831809001140246, 'NDCG10': 0.0030831809001140246, 'HR1': 0.0017657445556209534, 'HR5': 0.002354326074161271, 'HR10': 0.002354326074161271, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-128
{'epoch': 3, 'joint_loss_avg': '20.8303', 'main_loss_avg': '8.9933', 'gcl_loss_avg': '11.8317', 'mmd_loss_avg': '0.0528'}
{'Epoch': 3, 'X': {'MRR': 0.00984281035528807, 'NDCG5': 0.01429955404535868, 'NDCG10': 0.02118406435826705, 'HR1': 0.0018365472910927456, 'HR5': 0.018365472910927456, 'HR10': 0.03305785123966942, 'NUM': 1089}, 'Y': {'MRR': 0.0028055719050421816, 'NDCG5': 0.004356896357049543, 'NDCG10': 0.004904824982001865, 'HR1': 0.0017657445556209534, 'HR5': 0.004120070629782225, 'HR10': 0.00529723366686286, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-128
{'epoch': 4, 'joint_loss_avg': '20.1283', 'main_loss_avg': '8.5122', 'gcl_loss_avg': '11.6123', 'mmd_loss_avg': '0.0381'}
{'Epoch': 4, 'X': {'MRR': 0.013646334789585476, 'NDCG5': 0.019157602889908462, 'NDCG10': 0.027125895352600744, 'HR1': 0.005509641873278237, 'HR5': 0.021120293847566574, 'HR10': 0.03856749311294766, 'NUM': 1089}, 'Y': {'MRR': 0.004396398186863167, 'NDCG5': 0.00688070250970174, 'NDCG10': 0.008032317214386093, 'HR1': 0.0017657445556209534, 'HR5': 0.007062978222483814, 'HR10': 0.009417304296645085, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-128
{'epoch': 5, 'joint_loss_avg': '19.4673', 'main_loss_avg': '7.9306', 'gcl_loss_avg': '11.5343', 'mmd_loss_avg': '0.0243'}
{'Epoch': 5, 'X': {'MRR': 0.012694606943918238, 'NDCG5': 0.018047879080420288, 'NDCG10': 0.026948667591321845, 'HR1': 0.0036730945821854912, 'HR5': 0.02295684113865932, 'HR10': 0.04224058769513315, 'NUM': 1089}, 'Y': {'MRR': 0.005079318366546147, 'NDCG5': 0.00808395855317753, 'NDCG10': 0.010579882313479689, 'HR1': 0.0017657445556209534, 'HR5': 0.009417304296645085, 'HR10': 0.014714537963507945, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-128
{'epoch': 6, 'joint_loss_avg': '18.9404', 'main_loss_avg': '7.4356', 'gcl_loss_avg': '11.5025', 'mmd_loss_avg': '0.0240'}
{'Epoch': 6, 'X': {'MRR': 0.014368432167411262, 'NDCG5': 0.01943311965543152, 'NDCG10': 0.028010916954001465, 'HR1': 0.004591368227731864, 'HR5': 0.02203856749311295, 'HR10': 0.04040404040404041, 'NUM': 1089}, 'Y': {'MRR': 0.006934539203520956, 'NDCG5': 0.01176526109379634, 'NDCG10': 0.014025887443300829, 'HR1': 0.002354326074161271, 'HR5': 0.014125956444967627, 'HR10': 0.01883460859329017, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-128
{'epoch': 7, 'joint_loss_avg': '18.4031', 'main_loss_avg': '6.9221', 'gcl_loss_avg': '11.4787', 'mmd_loss_avg': '0.0229'}
{'Epoch': 7, 'X': {'MRR': 0.014305189370008681, 'NDCG5': 0.02072105039149962, 'NDCG10': 0.029995043821893407, 'HR1': 0.0027548209366391185, 'HR5': 0.024793388429752067, 'HR10': 0.04499540863177227, 'NUM': 1089}, 'Y': {'MRR': 0.007831913688299795, 'NDCG5': 0.012772394794520442, 'NDCG10': 0.015840817775840375, 'HR1': 0.002942907592701589, 'HR5': 0.015303119482048263, 'HR10': 0.02177751618599176, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-128
{'epoch': 8, 'joint_loss_avg': '17.8776', 'main_loss_avg': '6.4086', 'gcl_loss_avg': '11.4667', 'mmd_loss_avg': '0.0237'}
{'Epoch': 8, 'X': {'MRR': 0.016544581833838033, 'NDCG5': 0.023596634025626697, 'NDCG10': 0.03239589543880835, 'HR1': 0.006427915518824609, 'HR5': 0.02662993572084481, 'HR10': 0.04499540863177227, 'NUM': 1089}, 'Y': {'MRR': 0.008320903803540648, 'NDCG5': 0.013389582861662107, 'NDCG10': 0.015565765528997527, 'HR1': 0.004120070629782225, 'HR5': 0.014714537963507945, 'HR10': 0.01942319011183049, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 9, 'joint_loss_avg': '17.3765', 'main_loss_avg': '5.9218', 'gcl_loss_avg': '11.4519', 'mmd_loss_avg': '0.0277'}
{'Epoch': 9, 'X': {'MRR': 0.016803275033302582, 'NDCG5': 0.024861006623688255, 'NDCG10': 0.03357259550276775, 'HR1': 0.004591368227731864, 'HR5': 0.02938475665748393, 'HR10': 0.047750229568411386, 'NUM': 1089}, 'Y': {'MRR': 0.00767421545820604, 'NDCG5': 0.012407148345599384, 'NDCG10': 0.015185357547661177, 'HR1': 0.003531489111241907, 'HR5': 0.014125956444967627, 'HR10': 0.020011771630370805, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-128
{'epoch': 10, 'joint_loss_avg': '16.8582', 'main_loss_avg': '5.4189', 'gcl_loss_avg': '11.4371', 'mmd_loss_avg': '0.0221'}
{'Epoch': 10, 'X': {'MRR': 0.016637906272892505, 'NDCG5': 0.025240737099938754, 'NDCG10': 0.03166605028834859, 'HR1': 0.006427915518824609, 'HR5': 0.02938475665748393, 'HR10': 0.04315886134067952, 'NUM': 1089}, 'Y': {'MRR': 0.007655763894727991, 'NDCG5': 0.01241874219938585, 'NDCG10': 0.014664958100252196, 'HR1': 0.003531489111241907, 'HR5': 0.01353737492642731, 'HR10': 0.018246027074749854, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 11, 'joint_loss_avg': '16.5286', 'main_loss_avg': '5.0955', 'gcl_loss_avg': '11.4312', 'mmd_loss_avg': '0.0186'}
{'Epoch': 11, 'X': {'MRR': 0.01678912353843483, 'NDCG5': 0.0265805021535104, 'NDCG10': 0.03412423917536649, 'HR1': 0.006427915518824609, 'HR5': 0.03213957759412305, 'HR10': 0.048668503213957756, 'NUM': 1089}, 'Y': {'MRR': 0.008398786236095378, 'NDCG5': 0.012843314018364355, 'NDCG10': 0.015365905514773853, 'HR1': 0.004708652148322542, 'HR5': 0.012948793407886992, 'HR10': 0.018246027074749854, 'NUM': 1699}}
EarlyStopping counter: 2 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 12, 'joint_loss_avg': '16.2250', 'main_loss_avg': '4.7972', 'gcl_loss_avg': '11.4259', 'mmd_loss_avg': '0.0190'}
{'Epoch': 12, 'X': {'MRR': 0.01837131633558468, 'NDCG5': 0.0294451803517038, 'NDCG10': 0.03545104687059328, 'HR1': 0.006427915518824609, 'HR5': 0.03489439853076217, 'HR10': 0.047750229568411386, 'NUM': 1089}, 'Y': {'MRR': 0.00716574642413371, 'NDCG5': 0.01161535821693802, 'NDCG10': 0.014626767689755599, 'HR1': 0.002354326074161271, 'HR5': 0.01353737492642731, 'HR10': 0.020011771630370805, 'NUM': 1699}}
EarlyStopping counter: 3 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 13, 'joint_loss_avg': '15.9341', 'main_loss_avg': '4.5097', 'gcl_loss_avg': '11.4226', 'mmd_loss_avg': '0.0176'}
{'Epoch': 13, 'X': {'MRR': 0.017235983076203457, 'NDCG5': 0.026547437819227786, 'NDCG10': 0.034119640942438315, 'HR1': 0.0073461891643709825, 'HR5': 0.031221303948576674, 'HR10': 0.047750229568411386, 'NUM': 1089}, 'Y': {'MRR': 0.00727679145130587, 'NDCG5': 0.011585158320188025, 'NDCG10': 0.013780764174931782, 'HR1': 0.002942907592701589, 'HR5': 0.012948793407886992, 'HR10': 0.017657445556209534, 'NUM': 1699}}
EarlyStopping counter: 4 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 14, 'joint_loss_avg': '15.7164', 'main_loss_avg': '4.2983', 'gcl_loss_avg': '11.4164', 'mmd_loss_avg': '0.0179'}
{'Epoch': 14, 'X': {'MRR': 0.01981917811807619, 'NDCG5': 0.03007451043472558, 'NDCG10': 0.03829379992437607, 'HR1': 0.008264462809917356, 'HR5': 0.03397612488521579, 'HR10': 0.051423324150596875, 'NUM': 1089}, 'Y': {'MRR': 0.007386581275633658, 'NDCG5': 0.011411148688277558, 'NDCG10': 0.014665100120591808, 'HR1': 0.002942907592701589, 'HR5': 0.012360211889346674, 'HR10': 0.01942319011183049, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-128
{'epoch': 15, 'joint_loss_avg': '15.4377', 'main_loss_avg': '4.0252', 'gcl_loss_avg': '11.4107', 'mmd_loss_avg': '0.0185'}
{'Epoch': 15, 'X': {'MRR': 0.021368582697783797, 'NDCG5': 0.03135621827249525, 'NDCG10': 0.041357744197711356, 'HR1': 0.011019283746556474, 'HR5': 0.03397612488521579, 'HR10': 0.05509641873278237, 'NUM': 1089}, 'Y': {'MRR': 0.007315186852025129, 'NDCG5': 0.011547945660971802, 'NDCG10': 0.014033843943733566, 'HR1': 0.002942907592701589, 'HR5': 0.012948793407886992, 'HR10': 0.018246027074749854, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-128
{'epoch': 16, 'joint_loss_avg': '15.2822', 'main_loss_avg': '3.8719', 'gcl_loss_avg': '11.4087', 'mmd_loss_avg': '0.0165'}
{'Epoch': 16, 'X': {'MRR': 0.0202482982786013, 'NDCG5': 0.03156417162594023, 'NDCG10': 0.04030541612098698, 'HR1': 0.008264462809917356, 'HR5': 0.03673094582185491, 'HR10': 0.05509641873278237, 'NUM': 1089}, 'Y': {'MRR': 0.00695225414177739, 'NDCG5': 0.011466967390457314, 'NDCG10': 0.013510822409126176, 'HR1': 0.002354326074161271, 'HR5': 0.01353737492642731, 'HR10': 0.017657445556209534, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 17, 'joint_loss_avg': '15.1712', 'main_loss_avg': '3.7644', 'gcl_loss_avg': '11.4051', 'mmd_loss_avg': '0.0170'}
{'Epoch': 17, 'X': {'MRR': 0.020459080372384534, 'NDCG5': 0.03068907120426047, 'NDCG10': 0.03973421904473155, 'HR1': 0.008264462809917356, 'HR5': 0.03489439853076217, 'HR10': 0.05417814508723599, 'NUM': 1089}, 'Y': {'MRR': 0.0068604275196388195, 'NDCG5': 0.010883945698327529, 'NDCG10': 0.013967620214604834, 'HR1': 0.0017657445556209534, 'HR5': 0.012948793407886992, 'HR10': 0.01942319011183049, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-128
{'epoch': 18, 'joint_loss_avg': '15.0095', 'main_loss_avg': '3.6039', 'gcl_loss_avg': '11.4039', 'mmd_loss_avg': '0.0159'}
{'Epoch': 18, 'X': {'MRR': 0.021762174413689557, 'NDCG5': 0.03386448172311347, 'NDCG10': 0.04243305879328872, 'HR1': 0.010101010101010102, 'HR5': 0.03764921946740129, 'HR10': 0.05601469237832874, 'NUM': 1089}, 'Y': {'MRR': 0.006860892197855117, 'NDCG5': 0.009867805190926279, 'NDCG10': 0.013224367439095278, 'HR1': 0.002354326074161271, 'HR5': 0.01059446733372572, 'HR10': 0.017657445556209534, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-128
{'epoch': 19, 'joint_loss_avg': '14.9046', 'main_loss_avg': '3.4985', 'gcl_loss_avg': '11.4044', 'mmd_loss_avg': '0.0171'}
{'Epoch': 19, 'X': {'MRR': 0.020188160477416665, 'NDCG5': 0.03076046299003651, 'NDCG10': 0.04069424496665984, 'HR1': 0.0073461891643709825, 'HR5': 0.03581267217630854, 'HR10': 0.05693296602387511, 'NUM': 1089}, 'Y': {'MRR': 0.007222566198434356, 'NDCG5': 0.010806474095690737, 'NDCG10': 0.013533579635466659, 'HR1': 0.002942907592701589, 'HR5': 0.011183048852266038, 'HR10': 0.017068864037669218, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-128
{'epoch': 20, 'joint_loss_avg': '14.7491', 'main_loss_avg': '3.3504', 'gcl_loss_avg': '11.3971', 'mmd_loss_avg': '0.0165'}
{'Epoch': 20, 'X': {'MRR': 0.02100606642617662, 'NDCG5': 0.03293607673656209, 'NDCG10': 0.040700630462911974, 'HR1': 0.009182736455463728, 'HR5': 0.03764921946740129, 'HR10': 0.05417814508723599, 'NUM': 1089}, 'Y': {'MRR': 0.006997189337147097, 'NDCG5': 0.011769842185116576, 'NDCG10': 0.0134073592674807, 'HR1': 0.002354326074161271, 'HR5': 0.01353737492642731, 'HR10': 0.017068864037669218, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 21, 'joint_loss_avg': '14.6629', 'main_loss_avg': '3.2658', 'gcl_loss_avg': '11.3954', 'mmd_loss_avg': '0.0170'}
{'Epoch': 21, 'X': {'MRR': 0.021272676920059838, 'NDCG5': 0.032134727121403604, 'NDCG10': 0.04194577467064281, 'HR1': 0.010101010101010102, 'HR5': 0.03581267217630854, 'HR10': 0.05693296602387511, 'NUM': 1089}, 'Y': {'MRR': 0.007666295512087153, 'NDCG5': 0.011766795900912234, 'NDCG10': 0.014570338136598849, 'HR1': 0.002942907592701589, 'HR5': 0.012360211889346674, 'HR10': 0.018246027074749854, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-128
{'epoch': 22, 'joint_loss_avg': '14.6072', 'main_loss_avg': '3.2124', 'gcl_loss_avg': '11.3934', 'mmd_loss_avg': '0.0151'}
{'Epoch': 22, 'X': {'MRR': 0.020207135737438757, 'NDCG5': 0.03188680466747638, 'NDCG10': 0.04008581677560677, 'HR1': 0.008264462809917356, 'HR5': 0.03673094582185491, 'HR10': 0.05417814508723599, 'NUM': 1089}, 'Y': {'MRR': 0.007078576384050192, 'NDCG5': 0.010462420736842528, 'NDCG10': 0.01324779583884346, 'HR1': 0.002942907592701589, 'HR5': 0.01059446733372572, 'HR10': 0.0164802825191289, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 23, 'joint_loss_avg': '14.5171', 'main_loss_avg': '3.1237', 'gcl_loss_avg': '11.3918', 'mmd_loss_avg': '0.0159'}
{'Epoch': 23, 'X': {'MRR': 0.02090304221846921, 'NDCG5': 0.03144330454340588, 'NDCG10': 0.04079515496814658, 'HR1': 0.009182736455463728, 'HR5': 0.03489439853076217, 'HR10': 0.05509641873278237, 'NUM': 1089}, 'Y': {'MRR': 0.0062315112785978, 'NDCG5': 0.009167052379449973, 'NDCG10': 0.012580549487361465, 'HR1': 0.0017657445556209534, 'HR5': 0.010005885815185403, 'HR10': 0.017068864037669218, 'NUM': 1699}}
EarlyStopping counter: 2 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 24, 'joint_loss_avg': '14.4625', 'main_loss_avg': '3.0697', 'gcl_loss_avg': '11.3911', 'mmd_loss_avg': '0.0172'}
{'Epoch': 24, 'X': {'MRR': 0.022252089814073277, 'NDCG5': 0.034219219317844586, 'NDCG10': 0.04274172944036979, 'HR1': 0.011019283746556474, 'HR5': 0.03856749311294766, 'HR10': 0.05693296602387511, 'NUM': 1089}, 'Y': {'MRR': 0.008042902914886433, 'NDCG5': 0.011867892264767864, 'NDCG10': 0.01460717644325312, 'HR1': 0.004708652148322542, 'HR5': 0.011771630370806356, 'HR10': 0.017657445556209534, 'NUM': 1699}}
EarlyStopping counter: 3 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 25, 'joint_loss_avg': '14.3542', 'main_loss_avg': '2.9648', 'gcl_loss_avg': '11.3878', 'mmd_loss_avg': '0.0167'}
{'Epoch': 25, 'X': {'MRR': 0.022988839035670994, 'NDCG5': 0.03574960248515313, 'NDCG10': 0.04288544080509733, 'HR1': 0.011019283746556474, 'HR5': 0.03948576675849403, 'HR10': 0.05509641873278237, 'NUM': 1089}, 'Y': {'MRR': 0.0074889631982039285, 'NDCG5': 0.011581652225599494, 'NDCG10': 0.013544057809587466, 'HR1': 0.003531489111241907, 'HR5': 0.011771630370806356, 'HR10': 0.015891701000588582, 'NUM': 1699}}
EarlyStopping counter: 4 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 26, 'joint_loss_avg': '14.3013', 'main_loss_avg': '2.9120', 'gcl_loss_avg': '11.3877', 'mmd_loss_avg': '0.0156'}
{'Epoch': 26, 'X': {'MRR': 0.023846857662284653, 'NDCG5': 0.03563824159889485, 'NDCG10': 0.04484900454065109, 'HR1': 0.011937557392102846, 'HR5': 0.03764921946740129, 'HR10': 0.05785123966942149, 'NUM': 1089}, 'Y': {'MRR': 0.007500114658737378, 'NDCG5': 0.012090248599296827, 'NDCG10': 0.013548584671919345, 'HR1': 0.003531489111241907, 'HR5': 0.012948793407886992, 'HR10': 0.015891701000588582, 'NUM': 1699}}
EarlyStopping counter: 5 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 27, 'joint_loss_avg': '14.2603', 'main_loss_avg': '2.8742', 'gcl_loss_avg': '11.3845', 'mmd_loss_avg': '0.0153'}
{'Epoch': 27, 'X': {'MRR': 0.021611318094870192, 'NDCG5': 0.03084683188919074, 'NDCG10': 0.04127487288359455, 'HR1': 0.010101010101010102, 'HR5': 0.03213957759412305, 'HR10': 0.05417814508723599, 'NUM': 1089}, 'Y': {'MRR': 0.007701237027311189, 'NDCG5': 0.012006224044578, 'NDCG10': 0.01393820520741109, 'HR1': 0.003531489111241907, 'HR5': 0.012360211889346674, 'HR10': 0.0164802825191289, 'NUM': 1699}}
EarlyStopping counter: 6 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 28, 'joint_loss_avg': '14.2138', 'main_loss_avg': '2.8272', 'gcl_loss_avg': '11.3850', 'mmd_loss_avg': '0.0157'}
{'Epoch': 28, 'X': {'MRR': 0.023626756607634903, 'NDCG5': 0.03584547758058343, 'NDCG10': 0.04444923924766139, 'HR1': 0.011019283746556474, 'HR5': 0.03856749311294766, 'HR10': 0.05693296602387511, 'NUM': 1089}, 'Y': {'MRR': 0.006741148133143424, 'NDCG5': 0.010821574044065736, 'NDCG10': 0.012409322166626501, 'HR1': 0.002354326074161271, 'HR5': 0.011771630370806356, 'HR10': 0.015303119482048263, 'NUM': 1699}}
EarlyStopping counter: 7 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 29, 'joint_loss_avg': '14.1586', 'main_loss_avg': '2.7730', 'gcl_loss_avg': '11.3840', 'mmd_loss_avg': '0.0160'}
{'Epoch': 29, 'X': {'MRR': 0.02130282226700959, 'NDCG5': 0.032207796060023684, 'NDCG10': 0.040168180512554864, 'HR1': 0.008264462809917356, 'HR5': 0.03581267217630854, 'HR10': 0.05325987144168962, 'NUM': 1089}, 'Y': {'MRR': 0.0077894050230718865, 'NDCG5': 0.011969011385361774, 'NDCG10': 0.01421154924994044, 'HR1': 0.003531489111241907, 'HR5': 0.012360211889346674, 'HR10': 0.017068864037669218, 'NUM': 1699}}
EarlyStopping counter: 8 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 30, 'joint_loss_avg': '14.1196', 'main_loss_avg': '2.7358', 'gcl_loss_avg': '11.3824', 'mmd_loss_avg': '0.0145'}
{'Epoch': 30, 'X': {'MRR': 0.021072333051752913, 'NDCG5': 0.03243930755147522, 'NDCG10': 0.040267616472959795, 'HR1': 0.0073461891643709825, 'HR5': 0.03673094582185491, 'HR10': 0.05325987144168962, 'NUM': 1089}, 'Y': {'MRR': 0.007805676110561336, 'NDCG5': 0.011820620558881069, 'NDCG10': 0.014247408193098592, 'HR1': 0.004120070629782225, 'HR5': 0.011771630370806356, 'HR10': 0.017068864037669218, 'NUM': 1699}}
EarlyStopping counter: 9 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 31, 'joint_loss_avg': '14.0856', 'main_loss_avg': '2.7018', 'gcl_loss_avg': '11.3823', 'mmd_loss_avg': '0.0145'}
{'Epoch': 31, 'X': {'MRR': 0.022384079546613974, 'NDCG5': 0.03304911567007974, 'NDCG10': 0.04369469969403929, 'HR1': 0.008264462809917356, 'HR5': 0.03581267217630854, 'HR10': 0.05876951331496786, 'NUM': 1089}, 'Y': {'MRR': 0.007006441011738245, 'NDCG5': 0.011532845712596803, 'NDCG10': 0.013385474580790886, 'HR1': 0.002942907592701589, 'HR5': 0.012948793407886992, 'HR10': 0.017068864037669218, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-128
{'epoch': 32, 'joint_loss_avg': '14.0579', 'main_loss_avg': '2.6748', 'gcl_loss_avg': '11.3816', 'mmd_loss_avg': '0.0153'}
{'Epoch': 32, 'X': {'MRR': 0.02128517070840672, 'NDCG5': 0.030754275595593298, 'NDCG10': 0.039802782683838515, 'HR1': 0.008264462809917356, 'HR5': 0.03397612488521579, 'HR10': 0.05325987144168962, 'NUM': 1089}, 'Y': {'MRR': 0.007153469609325996, 'NDCG5': 0.0111415206478618, 'NDCG10': 0.013475801592524827, 'HR1': 0.002942907592701589, 'HR5': 0.011771630370806356, 'HR10': 0.017068864037669218, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 33, 'joint_loss_avg': '14.0142', 'main_loss_avg': '2.6295', 'gcl_loss_avg': '11.3832', 'mmd_loss_avg': '0.0155'}
{'Epoch': 33, 'X': {'MRR': 0.02189173352680077, 'NDCG5': 0.033797878092123035, 'NDCG10': 0.04200390539305509, 'HR1': 0.0073461891643709825, 'HR5': 0.03856749311294766, 'HR10': 0.05601469237832874, 'NUM': 1089}, 'Y': {'MRR': 0.007366136250774274, 'NDCG5': 0.011735061197046344, 'NDCG10': 0.013662870707428474, 'HR1': 0.003531489111241907, 'HR5': 0.012948793407886992, 'HR10': 0.017068864037669218, 'NUM': 1699}}
EarlyStopping counter: 2 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 34, 'joint_loss_avg': '13.9858', 'main_loss_avg': '2.6032', 'gcl_loss_avg': '11.3810', 'mmd_loss_avg': '0.0162'}
{'Epoch': 34, 'X': {'MRR': 0.023223223567576175, 'NDCG5': 0.034025318800545386, 'NDCG10': 0.04459257322241822, 'HR1': 0.011937557392102846, 'HR5': 0.03581267217630854, 'HR10': 0.05876951331496786, 'NUM': 1089}, 'Y': {'MRR': 0.007246290103853376, 'NDCG5': 0.010860298753659573, 'NDCG10': 0.013632160514468654, 'HR1': 0.003531489111241907, 'HR5': 0.011183048852266038, 'HR10': 0.017068864037669218, 'NUM': 1699}}
EarlyStopping counter: 3 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 35, 'joint_loss_avg': '13.9507', 'main_loss_avg': '2.5702', 'gcl_loss_avg': '11.3790', 'mmd_loss_avg': '0.0154'}
{'Epoch': 35, 'X': {'MRR': 0.023666485779595483, 'NDCG5': 0.034050554091395964, 'NDCG10': 0.04455707975747767, 'HR1': 0.011019283746556474, 'HR5': 0.03489439853076217, 'HR10': 0.05785123966942149, 'NUM': 1089}, 'Y': {'MRR': 0.007256588157117879, 'NDCG5': 0.011856298410981398, 'NDCG10': 0.013183416089119668, 'HR1': 0.004120070629782225, 'HR5': 0.012948793407886992, 'HR10': 0.015891701000588582, 'NUM': 1699}}
EarlyStopping counter: 4 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 36, 'joint_loss_avg': '13.9369', 'main_loss_avg': '2.5566', 'gcl_loss_avg': '11.3788', 'mmd_loss_avg': '0.0148'}
{'Epoch': 36, 'X': {'MRR': 0.0220840772838018, 'NDCG5': 0.032759546962826215, 'NDCG10': 0.041796995069593036, 'HR1': 0.009182736455463728, 'HR5': 0.03489439853076217, 'HR10': 0.05509641873278237, 'NUM': 1089}, 'Y': {'MRR': 0.007861929124436482, 'NDCG5': 0.011682748589455122, 'NDCG10': 0.013650166912213291, 'HR1': 0.00529723366686286, 'HR5': 0.011183048852266038, 'HR10': 0.015303119482048263, 'NUM': 1699}}
EarlyStopping counter: 5 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 37, 'joint_loss_avg': '13.9069', 'main_loss_avg': '2.5275', 'gcl_loss_avg': '11.3779', 'mmd_loss_avg': '0.0151'}
{'Epoch': 37, 'X': {'MRR': 0.021557212810656333, 'NDCG5': 0.03240241484349463, 'NDCG10': 0.04252786288235474, 'HR1': 0.008264462809917356, 'HR5': 0.03581267217630854, 'HR10': 0.05785123966942149, 'NUM': 1089}, 'Y': {'MRR': 0.007667603797680314, 'NDCG5': 0.012053495750464795, 'NDCG10': 0.013663582659162208, 'HR1': 0.004120070629782225, 'HR5': 0.012360211889346674, 'HR10': 0.015891701000588582, 'NUM': 1699}}
EarlyStopping counter: 6 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 38, 'joint_loss_avg': '13.9116', 'main_loss_avg': '2.5318', 'gcl_loss_avg': '11.3782', 'mmd_loss_avg': '0.0148'}
{'Epoch': 38, 'X': {'MRR': 0.02168557261532468, 'NDCG5': 0.03314570724285113, 'NDCG10': 0.041353816875755456, 'HR1': 0.008264462809917356, 'HR5': 0.03673094582185491, 'HR10': 0.05417814508723599, 'NUM': 1089}, 'Y': {'MRR': 0.0075382876883759746, 'NDCG5': 0.010860298753659573, 'NDCG10': 0.013382890250069068, 'HR1': 0.004120070629782225, 'HR5': 0.01059446733372572, 'HR10': 0.015891701000588582, 'NUM': 1699}}
EarlyStopping counter: 7 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 39, 'joint_loss_avg': '13.8548', 'main_loss_avg': '2.4756', 'gcl_loss_avg': '11.3778', 'mmd_loss_avg': '0.0149'}
{'Epoch': 39, 'X': {'MRR': 0.02128864146770482, 'NDCG5': 0.030333616237772934, 'NDCG10': 0.04148215480141051, 'HR1': 0.008264462809917356, 'HR5': 0.03305785123966942, 'HR10': 0.05693296602387511, 'NUM': 1089}, 'Y': {'MRR': 0.007804799020219856, 'NDCG5': 0.01175671409750338, 'NDCG10': 0.014025841049429517, 'HR1': 0.004708652148322542, 'HR5': 0.011771630370806356, 'HR10': 0.0164802825191289, 'NUM': 1699}}
EarlyStopping counter: 8 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 40, 'joint_loss_avg': '13.8494', 'main_loss_avg': '2.4711', 'gcl_loss_avg': '11.3769', 'mmd_loss_avg': '0.0143'}
{'Epoch': 40, 'X': {'MRR': 0.02160458407014881, 'NDCG5': 0.030202525587206094, 'NDCG10': 0.04399010937343297, 'HR1': 0.008264462809917356, 'HR5': 0.03213957759412305, 'HR10': 0.06152433425160698, 'NUM': 1089}, 'Y': {'MRR': 0.00771092748726651, 'NDCG5': 0.012366429591794629, 'NDCG10': 0.013781668988389648, 'HR1': 0.004120070629782225, 'HR5': 0.012948793407886992, 'HR10': 0.015891701000588582, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-128
{'epoch': 41, 'joint_loss_avg': '13.8130', 'main_loss_avg': '2.4351', 'gcl_loss_avg': '11.3765', 'mmd_loss_avg': '0.0149'}
{'Epoch': 41, 'X': {'MRR': 0.021720802919150017, 'NDCG5': 0.031997449076393555, 'NDCG10': 0.04111114628162782, 'HR1': 0.010101010101010102, 'HR5': 0.03397612488521579, 'HR10': 0.05325987144168962, 'NUM': 1089}, 'Y': {'MRR': 0.007811105250775645, 'NDCG5': 0.011428220497414359, 'NDCG10': 0.014146421943485619, 'HR1': 0.004708652148322542, 'HR5': 0.011183048852266038, 'HR10': 0.017068864037669218, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 42, 'joint_loss_avg': '13.8109', 'main_loss_avg': '2.4322', 'gcl_loss_avg': '11.3773', 'mmd_loss_avg': '0.0149'}
{'Epoch': 42, 'X': {'MRR': 0.022463534068217265, 'NDCG5': 0.03098031706435804, 'NDCG10': 0.043145629660101194, 'HR1': 0.009182736455463728, 'HR5': 0.03213957759412305, 'HR10': 0.05785123966942149, 'NUM': 1089}, 'Y': {'MRR': 0.007981373475781952, 'NDCG5': 0.012070107749217403, 'NDCG10': 0.014179116760623155, 'HR1': 0.00529723366686286, 'HR5': 0.011771630370806356, 'HR10': 0.0164802825191289, 'NUM': 1699}}
EarlyStopping counter: 2 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 43, 'joint_loss_avg': '13.7985', 'main_loss_avg': '2.4204', 'gcl_loss_avg': '11.3767', 'mmd_loss_avg': '0.0149'}
{'Epoch': 43, 'X': {'MRR': 0.021910737247115383, 'NDCG5': 0.0323522221749799, 'NDCG10': 0.04199982435609526, 'HR1': 0.008264462809917356, 'HR5': 0.03489439853076217, 'HR10': 0.05509641873278237, 'NUM': 1089}, 'Y': {'MRR': 0.008494726122742605, 'NDCG5': 0.013609945151980152, 'NDCG10': 0.01494924146882776, 'HR1': 0.00529723366686286, 'HR5': 0.01353737492642731, 'HR10': 0.0164802825191289, 'NUM': 1699}}
EarlyStopping counter: 3 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 44, 'joint_loss_avg': '13.7855', 'main_loss_avg': '2.4073', 'gcl_loss_avg': '11.3768', 'mmd_loss_avg': '0.0146'}
{'Epoch': 44, 'X': {'MRR': 0.021653605296855984, 'NDCG5': 0.032914913123156024, 'NDCG10': 0.041216851948428924, 'HR1': 0.009182736455463728, 'HR5': 0.03581267217630854, 'HR10': 0.05417814508723599, 'NUM': 1089}, 'Y': {'MRR': 0.007467730098689486, 'NDCG5': 0.011232557965046856, 'NDCG10': 0.013412990933593104, 'HR1': 0.004120070629782225, 'HR5': 0.011183048852266038, 'HR10': 0.015891701000588582, 'NUM': 1699}}
EarlyStopping counter: 4 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 45, 'joint_loss_avg': '13.7704', 'main_loss_avg': '2.3938', 'gcl_loss_avg': '11.3752', 'mmd_loss_avg': '0.0144'}
{'Epoch': 45, 'X': {'MRR': 0.021701572837936473, 'NDCG5': 0.030864202632754065, 'NDCG10': 0.04305428825403945, 'HR1': 0.009182736455463728, 'HR5': 0.03213957759412305, 'HR10': 0.05876951331496786, 'NUM': 1089}, 'Y': {'MRR': 0.007926704777793654, 'NDCG5': 0.012037935991705606, 'NDCG10': 0.014510679879551885, 'HR1': 0.004120070629782225, 'HR5': 0.012360211889346674, 'HR10': 0.017657445556209534, 'NUM': 1699}}
EarlyStopping counter: 5 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 46, 'joint_loss_avg': '13.7457', 'main_loss_avg': '2.3687', 'gcl_loss_avg': '11.3756', 'mmd_loss_avg': '0.0142'}
{'Epoch': 46, 'X': {'MRR': 0.0212863522740366, 'NDCG5': 0.029879175173913544, 'NDCG10': 0.04161746589840581, 'HR1': 0.009182736455463728, 'HR5': 0.031221303948576674, 'HR10': 0.05601469237832874, 'NUM': 1089}, 'Y': {'MRR': 0.007954768402090355, 'NDCG5': 0.011793926756719605, 'NDCG10': 0.013785018568096935, 'HR1': 0.00529723366686286, 'HR5': 0.011183048852266038, 'HR10': 0.015303119482048263, 'NUM': 1699}}
EarlyStopping counter: 6 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 47, 'joint_loss_avg': '13.7501', 'main_loss_avg': '2.3739', 'gcl_loss_avg': '11.3747', 'mmd_loss_avg': '0.0152'}
{'Epoch': 47, 'X': {'MRR': 0.022376961116630546, 'NDCG5': 0.0325287528431311, 'NDCG10': 0.04258633422977765, 'HR1': 0.010101010101010102, 'HR5': 0.03397612488521579, 'HR10': 0.05601469237832874, 'NUM': 1089}, 'Y': {'MRR': 0.007679905928875914, 'NDCG5': 0.012388542302635855, 'NDCG10': 0.013487393800028677, 'HR1': 0.004120070629782225, 'HR5': 0.012948793407886992, 'HR10': 0.015303119482048263, 'NUM': 1699}}
EarlyStopping counter: 7 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 48, 'joint_loss_avg': '13.7460', 'main_loss_avg': '2.3700', 'gcl_loss_avg': '11.3746', 'mmd_loss_avg': '0.0142'}
{'Epoch': 48, 'X': {'MRR': 0.02131355023917007, 'NDCG5': 0.030551793159250423, 'NDCG10': 0.040331348167791624, 'HR1': 0.009182736455463728, 'HR5': 0.03213957759412305, 'HR10': 0.05325987144168962, 'NUM': 1089}, 'Y': {'MRR': 0.007429673851098217, 'NDCG5': 0.011114826845700336, 'NDCG10': 0.01337245894771665, 'HR1': 0.004120070629782225, 'HR5': 0.011183048852266038, 'HR10': 0.015891701000588582, 'NUM': 1699}}
EarlyStopping counter: 8 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 49, 'joint_loss_avg': '13.7224', 'main_loss_avg': '2.3463', 'gcl_loss_avg': '11.3746', 'mmd_loss_avg': '0.0141'}
{'Epoch': 49, 'X': {'MRR': 0.021405962793096152, 'NDCG5': 0.031532067072745244, 'NDCG10': 0.043011540161307246, 'HR1': 0.008264462809917356, 'HR5': 0.03489439853076217, 'HR10': 0.05968778696051423, 'NUM': 1089}, 'Y': {'MRR': 0.00709106961314142, 'NDCG5': 0.011436767493707319, 'NDCG10': 0.013045957294958442, 'HR1': 0.003531489111241907, 'HR5': 0.012360211889346674, 'HR10': 0.015891701000588582, 'NUM': 1699}}
EarlyStopping counter: 9 out of 10
n_sample-[20, 20]-hidden_size-128
{'epoch': 50, 'joint_loss_avg': '13.7149', 'main_loss_avg': '2.3393', 'gcl_loss_avg': '11.3742', 'mmd_loss_avg': '0.0147'}
{'Epoch': 50, 'X': {'MRR': 0.022973787552589928, 'NDCG5': 0.03314642461460755, 'NDCG10': 0.04434622629840004, 'HR1': 0.010101010101010102, 'HR5': 0.03489439853076217, 'HR10': 0.05876951331496786, 'NUM': 1089}, 'Y': {'MRR': 0.007898500688377086, 'NDCG5': 0.01148708605708762, 'NDCG10': 0.013694949199300574, 'HR1': 0.00529723366686286, 'HR5': 0.01059446733372572, 'HR10': 0.015303119482048263, 'NUM': 1699}}
EarlyStopping counter: 10 out of 10
Early stopping
---------------Change to test_rating_matrix!-------------------
{'Epoch': 0, 'X': {'MRR': 0.025164339302418907, 'NDCG5': 0.03610887885033891, 'NDCG10': 0.04266200259962502, 'HR1': 0.017013232514177693, 'HR5': 0.034026465028355386, 'HR10': 0.048204158790170135, 'NUM': 1058}, 'Y': {'MRR': 0.010120036110269424, 'NDCG5': 0.01510962392098856, 'NDCG10': 0.0169034821380413, 'HR1': 0.007596310363537711, 'HR5': 0.013564839934888768, 'HR10': 0.017362995116657624, 'NUM': 1843}}
GCL4SR-fk-[20, 20]
{'Epoch': 0, 'X': {'MRR': 0.025164339302418907, 'NDCG5': 0.03610887885033891, 'NDCG10': 0.04266200259962502, 'HR1': 0.017013232514177693, 'HR5': 0.034026465028355386, 'HR10': 0.048204158790170135, 'NUM': 1058}, 'Y': {'MRR': 0.010120036110269424, 'NDCG5': 0.01510962392098856, 'NDCG10': 0.0169034821380413, 'HR1': 0.007596310363537711, 'HR5': 0.013564839934888768, 'HR10': 0.017362995116657624, 'NUM': 1843}}
