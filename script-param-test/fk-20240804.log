Namespace(model_name='GCL4SR', data_name='fk', data_dir='./datasets/fk/', output_dir='output/', do_eval=False, no_cuda=False, gpu_id='3', lr=0.001, lr_dc=0.7, lr_dc_step=5, weight_decay=5e-05, adam_beta1=0.9, adam_beta2=0.999, num_hidden_layers=2, num_attention_heads=2, hidden_act='gelu', attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, epochs=200, batch_size=256, max_seq_length=15, hidden_size=64, seed=2022, log_freq=1, patience=10, gnn_dropout_prob=0.5, use_renorm=True, use_scale=False, fast_run=True, sample_size=[20, 20], lam1=1, lam2=0.1, cuda_condition=True, data_file='./datasets/fk/fk.txt', x_domain_size=29208, item_size=64090, user_size=16573, log_file='output/GCL4SR-fk-[20, 20].txt')
n_sample-[20, 20]-hidden_size-64
{'epoch': 0, 'joint_loss_avg': '21.5963', 'main_loss_avg': '10.2469', 'gcl_loss_avg': '11.3338', 'mmd_loss_avg': '0.1556'}
{'Epoch': 0, 'X': {'MRR': 0.0054858020767111675, 'NDCG5': 0.007962067577626738, 'NDCG10': 0.008379991924103707, 'HR1': 0.0027548209366391185, 'HR5': 0.008264462809917356, 'HR10': 0.009182736455463728, 'NUM': 1089}, 'Y': {'MRR': 0.0005885815185403178, 'NDCG5': 0.000849143637957012, 'NDCG10': 0.000849143637957012, 'HR1': 0.0005885815185403178, 'HR5': 0.0005885815185403178, 'HR10': 0.0005885815185403178, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 1, 'joint_loss_avg': '18.3667', 'main_loss_avg': '9.3859', 'gcl_loss_avg': '8.9749', 'mmd_loss_avg': '0.0589'}
{'Epoch': 1, 'X': {'MRR': 0.0108738372816318, 'NDCG5': 0.013831778411525237, 'NDCG10': 0.02180768320673273, 'HR1': 0.0036730945821854912, 'HR5': 0.015610651974288337, 'HR10': 0.03213957759412305, 'NUM': 1089}, 'Y': {'MRR': 0.0016676476358642338, 'NDCG5': 0.0026586090811355186, 'NDCG10': 0.0026586090811355186, 'HR1': 0.0011771630370806356, 'HR5': 0.002354326074161271, 'HR10': 0.002354326074161271, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 2, 'joint_loss_avg': '17.6594', 'main_loss_avg': '8.8137', 'gcl_loss_avg': '8.8396', 'mmd_loss_avg': '0.0619'}
{'Epoch': 2, 'X': {'MRR': 0.016431607663302605, 'NDCG5': 0.02356285231958767, 'NDCG10': 0.03173119329077061, 'HR1': 0.006427915518824609, 'HR5': 0.02662993572084481, 'HR10': 0.0440771349862259, 'NUM': 1089}, 'Y': {'MRR': 0.003060623896409653, 'NDCG5': 0.0055279806430135366, 'NDCG10': 0.0058304517097408776, 'HR1': 0.0011771630370806356, 'HR5': 0.006474396703943496, 'HR10': 0.007062978222483814, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 3, 'joint_loss_avg': '16.9674', 'main_loss_avg': '8.1498', 'gcl_loss_avg': '8.8117', 'mmd_loss_avg': '0.0596'}
{'Epoch': 3, 'X': {'MRR': 0.015318766945859714, 'NDCG5': 0.022088167347335878, 'NDCG10': 0.03062176992541823, 'HR1': 0.004591368227731864, 'HR5': 0.02662993572084481, 'HR10': 0.04499540863177227, 'NUM': 1089}, 'Y': {'MRR': 0.006460382858263964, 'NDCG5': 0.012119373499315121, 'NDCG10': 0.012402421378634126, 'HR1': 0.002942907592701589, 'HR5': 0.014714537963507945, 'HR10': 0.015303119482048263, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 4, 'joint_loss_avg': '16.3066', 'main_loss_avg': '7.5091', 'gcl_loss_avg': '8.7919', 'mmd_loss_avg': '0.0571'}
{'Epoch': 4, 'X': {'MRR': 0.01663754688034213, 'NDCG5': 0.025618350964775227, 'NDCG10': 0.033548432391221225, 'HR1': 0.0036730945821854912, 'HR5': 0.031221303948576674, 'HR10': 0.048668503213957756, 'NUM': 1089}, 'Y': {'MRR': 0.00513913200787833, 'NDCG5': 0.009398392763917806, 'NDCG10': 0.010209946080780796, 'HR1': 0.0017657445556209534, 'HR5': 0.011771630370806356, 'HR10': 0.01353737492642731, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 5, 'joint_loss_avg': '15.6228', 'main_loss_avg': '6.8469', 'gcl_loss_avg': '8.7705', 'mmd_loss_avg': '0.0542'}
{'Epoch': 5, 'X': {'MRR': 0.015322870935818588, 'NDCG5': 0.023646861303581335, 'NDCG10': 0.03172777514790363, 'HR1': 0.0027548209366391185, 'HR5': 0.030303030303030304, 'HR10': 0.047750229568411386, 'NUM': 1089}, 'Y': {'MRR': 0.00627726860805142, 'NDCG5': 0.00986475833343277, 'NDCG10': 0.013858761648620413, 'HR1': 0.0011771630370806356, 'HR5': 0.012360211889346674, 'HR10': 0.020600353148911125, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 6, 'joint_loss_avg': '15.1616', 'main_loss_avg': '6.3964', 'gcl_loss_avg': '8.7601', 'mmd_loss_avg': '0.0507'}
{'Epoch': 6, 'X': {'MRR': 0.01684085388914427, 'NDCG5': 0.025552429201685982, 'NDCG10': 0.03465958271375007, 'HR1': 0.004591368227731864, 'HR5': 0.031221303948576674, 'HR10': 0.050505050505050504, 'NUM': 1089}, 'Y': {'MRR': 0.005829781035784568, 'NDCG5': 0.009955795650617832, 'NDCG10': 0.012491462893182955, 'HR1': 0.0011771630370806356, 'HR5': 0.012948793407886992, 'HR10': 0.018246027074749854, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 7, 'joint_loss_avg': '14.7690', 'main_loss_avg': '6.0079', 'gcl_loss_avg': '8.7564', 'mmd_loss_avg': '0.0475'}
{'Epoch': 7, 'X': {'MRR': 0.01724487363767869, 'NDCG5': 0.02748227260955358, 'NDCG10': 0.034213955573802454, 'HR1': 0.004591368227731864, 'HR5': 0.03397612488521579, 'HR10': 0.048668503213957756, 'NUM': 1089}, 'Y': {'MRR': 0.006604513137767992, 'NDCG5': 0.010380367469596337, 'NDCG10': 0.013901756299995854, 'HR1': 0.002354326074161271, 'HR5': 0.012360211889346674, 'HR10': 0.020011771630370805, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 8, 'joint_loss_avg': '14.3895', 'main_loss_avg': '5.6328', 'gcl_loss_avg': '8.7516', 'mmd_loss_avg': '0.0514'}
{'Epoch': 8, 'X': {'MRR': 0.01942424132101655, 'NDCG5': 0.028504158166934798, 'NDCG10': 0.03809570305826677, 'HR1': 0.008264462809917356, 'HR5': 0.03213957759412305, 'HR10': 0.05234159779614325, 'NUM': 1089}, 'Y': {'MRR': 0.005543665019827468, 'NDCG5': 0.0075884675103551095, 'NDCG10': 0.013492954288558425, 'HR1': 0.0011771630370806356, 'HR5': 0.010005885815185403, 'HR10': 0.022366097704532076, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 9, 'joint_loss_avg': '14.0954', 'main_loss_avg': '5.3471', 'gcl_loss_avg': '8.7441', 'mmd_loss_avg': '0.0415'}
{'Epoch': 9, 'X': {'MRR': 0.01840619796433918, 'NDCG5': 0.027673815000522878, 'NDCG10': 0.037594212084807004, 'HR1': 0.004591368227731864, 'HR5': 0.03305785123966942, 'HR10': 0.05417814508723599, 'NUM': 1089}, 'Y': {'MRR': 0.005208564243290552, 'NDCG5': 0.00786464850285291, 'NDCG10': 0.011693958733786194, 'HR1': 0.0011771630370806356, 'HR5': 0.01059446733372572, 'HR10': 0.01883460859329017, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 10, 'joint_loss_avg': '13.6861', 'main_loss_avg': '4.9482', 'gcl_loss_avg': '8.7339', 'mmd_loss_avg': '0.0395'}
{'Epoch': 10, 'X': {'MRR': 0.02082502871070364, 'NDCG5': 0.030551793159250416, 'NDCG10': 0.04079997562549463, 'HR1': 0.0073461891643709825, 'HR5': 0.03397612488521579, 'HR10': 0.05601469237832874, 'NUM': 1089}, 'Y': {'MRR': 0.005365674479859293, 'NDCG5': 0.007389298883399076, 'NDCG10': 0.011790749389073768, 'HR1': 0.0011771630370806356, 'HR5': 0.008828722778104767, 'HR10': 0.018246027074749854, 'NUM': 1699}}
EarlyStopping counter: 2 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 11, 'joint_loss_avg': '13.4529', 'main_loss_avg': '4.7190', 'gcl_loss_avg': '8.7301', 'mmd_loss_avg': '0.0382'}
{'Epoch': 11, 'X': {'MRR': 0.019458238290275234, 'NDCG5': 0.03318092279798768, 'NDCG10': 0.04090710748203882, 'HR1': 0.0036730945821854912, 'HR5': 0.04315886134067952, 'HR10': 0.05968778696051423, 'NUM': 1089}, 'Y': {'MRR': 0.006559668831593493, 'NDCG5': 0.010612782850795872, 'NDCG10': 0.013943989437707244, 'HR1': 0.0017657445556209534, 'HR5': 0.01353737492642731, 'HR10': 0.020600353148911125, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 12, 'joint_loss_avg': '13.2811', 'main_loss_avg': '4.5497', 'gcl_loss_avg': '8.7277', 'mmd_loss_avg': '0.0378'}
{'Epoch': 12, 'X': {'MRR': 0.020819483801577464, 'NDCG5': 0.03194010923234798, 'NDCG10': 0.042157988672507016, 'HR1': 0.006427915518824609, 'HR5': 0.03764921946740129, 'HR10': 0.05968778696051423, 'NUM': 1089}, 'Y': {'MRR': 0.006252765611211755, 'NDCG5': 0.009807864634521315, 'NDCG10': 0.013363031079840253, 'HR1': 0.002354326074161271, 'HR5': 0.011771630370806356, 'HR10': 0.01942319011183049, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 13, 'joint_loss_avg': '13.1065', 'main_loss_avg': '4.3764', 'gcl_loss_avg': '8.7263', 'mmd_loss_avg': '0.0385'}
{'Epoch': 13, 'X': {'MRR': 0.021371079945460104, 'NDCG5': 0.03316998275261408, 'NDCG10': 0.04085221812341916, 'HR1': 0.0073461891643709825, 'HR5': 0.03764921946740129, 'HR10': 0.05417814508723599, 'NUM': 1089}, 'Y': {'MRR': 0.006514831058680381, 'NDCG5': 0.009494011172423102, 'NDCG10': 0.013656272912365661, 'HR1': 0.002354326074161271, 'HR5': 0.011183048852266038, 'HR10': 0.020011771630370805, 'NUM': 1699}}
EarlyStopping counter: 2 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 14, 'joint_loss_avg': '12.9692', 'main_loss_avg': '4.2404', 'gcl_loss_avg': '8.7248', 'mmd_loss_avg': '0.0394'}
{'Epoch': 14, 'X': {'MRR': 0.01982726306984935, 'NDCG5': 0.0319793609610738, 'NDCG10': 0.042592682330596675, 'HR1': 0.005509641873278237, 'HR5': 0.03948576675849403, 'HR10': 0.06244260789715335, 'NUM': 1089}, 'Y': {'MRR': 0.005897026261946802, 'NDCG5': 0.009255042839141525, 'NDCG10': 0.013000806495352034, 'HR1': 0.0017657445556209534, 'HR5': 0.011183048852266038, 'HR10': 0.01942319011183049, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 15, 'joint_loss_avg': '12.7260', 'main_loss_avg': '4.0057', 'gcl_loss_avg': '8.7170', 'mmd_loss_avg': '0.0327'}
{'Epoch': 15, 'X': {'MRR': 0.020766168837794172, 'NDCG5': 0.03307027928348582, 'NDCG10': 0.04295451236106421, 'HR1': 0.006427915518824609, 'HR5': 0.03948576675849403, 'HR10': 0.06060606060606061, 'NUM': 1089}, 'Y': {'MRR': 0.0059703294547320445, 'NDCG5': 0.00920777113325473, 'NDCG10': 0.012569402141320981, 'HR1': 0.0011771630370806356, 'HR5': 0.011183048852266038, 'HR10': 0.018246027074749854, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 16, 'joint_loss_avg': '12.6149', 'main_loss_avg': '3.8947', 'gcl_loss_avg': '8.7169', 'mmd_loss_avg': '0.0325'}
{'Epoch': 16, 'X': {'MRR': 0.023035194363308028, 'NDCG5': 0.03743080606733708, 'NDCG10': 0.043878391568050235, 'HR1': 0.009182736455463728, 'HR5': 0.04315886134067952, 'HR10': 0.05693296602387511, 'NUM': 1089}, 'Y': {'MRR': 0.006770088847781608, 'NDCG5': 0.011355789223192829, 'NDCG10': 0.013749180816400107, 'HR1': 0.002354326074161271, 'HR5': 0.01353737492642731, 'HR10': 0.01883460859329017, 'NUM': 1699}}
EarlyStopping counter: 2 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 17, 'joint_loss_avg': '12.5106', 'main_loss_avg': '3.7920', 'gcl_loss_avg': '8.7155', 'mmd_loss_avg': '0.0315'}
{'Epoch': 17, 'X': {'MRR': 0.02187348795475517, 'NDCG5': 0.034537099708450356, 'NDCG10': 0.04243535761412075, 'HR1': 0.009182736455463728, 'HR5': 0.03948576675849403, 'HR10': 0.05601469237832874, 'NUM': 1089}, 'Y': {'MRR': 0.00658482188794137, 'NDCG5': 0.010857251896166067, 'NDCG10': 0.01328112393165528, 'HR1': 0.002354326074161271, 'HR5': 0.012948793407886992, 'HR10': 0.018246027074749854, 'NUM': 1699}}
EarlyStopping counter: 3 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 18, 'joint_loss_avg': '12.4305', 'main_loss_avg': '3.7127', 'gcl_loss_avg': '8.7147', 'mmd_loss_avg': '0.0314'}
{'Epoch': 18, 'X': {'MRR': 0.020094534075250328, 'NDCG5': 0.030663154045508696, 'NDCG10': 0.041967669100770086, 'HR1': 0.005509641873278237, 'HR5': 0.03673094582185491, 'HR10': 0.06060606060606061, 'NUM': 1089}, 'Y': {'MRR': 0.005979771650754583, 'NDCG5': 0.009017126745853372, 'NDCG10': 0.012344161680313779, 'HR1': 0.002354326074161271, 'HR5': 0.01059446733372572, 'HR10': 0.017657445556209534, 'NUM': 1699}}
EarlyStopping counter: 4 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 19, 'joint_loss_avg': '12.3288', 'main_loss_avg': '3.6115', 'gcl_loss_avg': '8.7142', 'mmd_loss_avg': '0.0301'}
{'Epoch': 19, 'X': {'MRR': 0.022181294116555818, 'NDCG5': 0.03383473619066372, 'NDCG10': 0.04540889700612955, 'HR1': 0.008264462809917356, 'HR5': 0.03856749311294766, 'HR10': 0.06336088154269973, 'NUM': 1089}, 'Y': {'MRR': 0.0065748504977463165, 'NDCG5': 0.00981945848830778, 'NDCG10': 0.013070056726857494, 'HR1': 0.002942907592701589, 'HR5': 0.01059446733372572, 'HR10': 0.017657445556209534, 'NUM': 1699}}
EarlyStopping counter: 5 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 20, 'joint_loss_avg': '12.2027', 'main_loss_avg': '3.4910', 'gcl_loss_avg': '8.7087', 'mmd_loss_avg': '0.0306'}
{'Epoch': 20, 'X': {'MRR': 0.02280853940228433, 'NDCG5': 0.03494442449629667, 'NDCG10': 0.045782988629079556, 'HR1': 0.010101010101010102, 'HR5': 0.03948576675849403, 'HR10': 0.06244260789715335, 'NUM': 1089}, 'Y': {'MRR': 0.006519007446023337, 'NDCG5': 0.010745613918517395, 'NDCG10': 0.013224267652580158, 'HR1': 0.002354326074161271, 'HR5': 0.012948793407886992, 'HR10': 0.018246027074749854, 'NUM': 1699}}
EarlyStopping counter: 6 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 21, 'joint_loss_avg': '12.1310', 'main_loss_avg': '3.4204', 'gcl_loss_avg': '8.7077', 'mmd_loss_avg': '0.0291'}
{'Epoch': 21, 'X': {'MRR': 0.023602172733188775, 'NDCG5': 0.035020569827418406, 'NDCG10': 0.04695141943150688, 'HR1': 0.011019283746556474, 'HR5': 0.03764921946740129, 'HR10': 0.06336088154269973, 'NUM': 1089}, 'Y': {'MRR': 0.006339885018519509, 'NDCG5': 0.009537776783721365, 'NDCG10': 0.012622628704961458, 'HR1': 0.002942907592701589, 'HR5': 0.01059446733372572, 'HR10': 0.017068864037669218, 'NUM': 1699}}
EarlyStopping counter: 7 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 22, 'joint_loss_avg': '12.0847', 'main_loss_avg': '3.3756', 'gcl_loss_avg': '8.7063', 'mmd_loss_avg': '0.0282'}
{'Epoch': 22, 'X': {'MRR': 0.023144179682828194, 'NDCG5': 0.03461324503957208, 'NDCG10': 0.04451672399011024, 'HR1': 0.010101010101010102, 'HR5': 0.03764921946740129, 'HR10': 0.05876951331496786, 'NUM': 1089}, 'Y': {'MRR': 0.006273223702593919, 'NDCG5': 0.010132392329637615, 'NDCG10': 0.012528755542700254, 'HR1': 0.002354326074161271, 'HR5': 0.011771630370806356, 'HR10': 0.017068864037669218, 'NUM': 1699}}
EarlyStopping counter: 8 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 23, 'joint_loss_avg': '12.0362', 'main_loss_avg': '3.3274', 'gcl_loss_avg': '8.7060', 'mmd_loss_avg': '0.0288'}
{'Epoch': 23, 'X': {'MRR': 0.022102525438694613, 'NDCG5': 0.03266770804098519, 'NDCG10': 0.04425381882693589, 'HR1': 0.008264462809917356, 'HR5': 0.03581267217630854, 'HR10': 0.06060606060606061, 'NUM': 1089}, 'Y': {'MRR': 0.00681446602576679, 'NDCG5': 0.010026255064077557, 'NDCG10': 0.013368821831011835, 'HR1': 0.002942907592701589, 'HR5': 0.01059446733372572, 'HR10': 0.017657445556209534, 'NUM': 1699}}
EarlyStopping counter: 9 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 24, 'joint_loss_avg': '11.9584', 'main_loss_avg': '3.2504', 'gcl_loss_avg': '8.7053', 'mmd_loss_avg': '0.0269'}
{'Epoch': 24, 'X': {'MRR': 0.02118589501509611, 'NDCG5': 0.03309144379130721, 'NDCG10': 0.04169627226937724, 'HR1': 0.008264462809917356, 'HR5': 0.03764921946740129, 'HR10': 0.05601469237832874, 'NUM': 1089}, 'Y': {'MRR': 0.006929619657694995, 'NDCG5': 0.01091762950621694, 'NDCG10': 0.012838194467900067, 'HR1': 0.004120070629782225, 'HR5': 0.011771630370806356, 'HR10': 0.015891701000588582, 'NUM': 1699}}
EarlyStopping counter: 10 out of 10
Early stopping
---------------Change to test_rating_matrix!-------------------
{'Epoch': 0, 'X': {'MRR': 0.02657108866521743, 'NDCG5': 0.040280536744034624, 'NDCG10': 0.048638907254994486, 'HR1': 0.014177693761814745, 'HR5': 0.04158790170132325, 'HR10': 0.05954631379962193, 'NUM': 1058}, 'Y': {'MRR': 0.009244154591414493, 'NDCG5': 0.014223911514632589, 'NDCG10': 0.015959762797519667, 'HR1': 0.0065111231687466084, 'HR5': 0.013564839934888768, 'HR10': 0.017362995116657624, 'NUM': 1843}}
GCL4SR-fk-[20, 20]
{'Epoch': 0, 'X': {'MRR': 0.02657108866521743, 'NDCG5': 0.040280536744034624, 'NDCG10': 0.048638907254994486, 'HR1': 0.014177693761814745, 'HR5': 0.04158790170132325, 'HR10': 0.05954631379962193, 'NUM': 1058}, 'Y': {'MRR': 0.009244154591414493, 'NDCG5': 0.014223911514632589, 'NDCG10': 0.015959762797519667, 'HR1': 0.0065111231687466084, 'HR5': 0.013564839934888768, 'HR10': 0.017362995116657624, 'NUM': 1843}}
