Namespace(model_name='GCL4SR', data_name='fk2', data_dir='./datasets/fk2/', output_dir='output2/', do_eval=False, no_cuda=False, gpu_id='3', lr=0.01, lr_dc=0.7, lr_dc_step=5, weight_decay=5e-05, adam_beta1=0.9, adam_beta2=0.999, num_hidden_layers=2, num_attention_heads=2, hidden_act='gelu', attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, epochs=200, batch_size=1024, max_seq_length=15, hidden_size=64, seed=2022, log_freq=1, patience=10, gnn_dropout_prob=0.5, use_renorm=True, use_scale=False, fast_run=True, sample_depth=2, sample_width=20, lam1=1, lam2=0.1, cuda_condition=True, sample_size=[20, 20], data_file='./datasets/fk2/fk2.txt', x_domain_size=29208, item_size=64090, user_size=5689, log_file='output2/GCL4SR-fk2-[20, 20].txt')
n_sample-[20, 20]-hidden_size-64
{'epoch': 0, 'joint_loss_avg': '24.4150', 'main_loss_avg': '10.1501', 'gcl_loss_avg': '14.0551', 'mmd_loss_avg': '2.0969'}
{'Epoch': 0, 'X': {'MRR': 0.006146248914843956, 'NDCG5': 0.009489338848578398, 'NDCG10': 0.012913406949274816, 'HR1': 0.0018365472910927456, 'HR5': 0.011937557392102846, 'HR10': 0.01928374655647383, 'NUM': 1089}, 'Y': {'MRR': 0.0021441183889683007, 'NDCG5': 0.003083180900114024, 'NDCG10': 0.0033662287794330283, 'HR1': 0.0017657445556209534, 'HR5': 0.002354326074161271, 'HR10': 0.002942907592701589, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 1, 'joint_loss_avg': '21.9824', 'main_loss_avg': '9.2692', 'gcl_loss_avg': '12.7022', 'mmd_loss_avg': '0.1109'}
{'Epoch': 1, 'X': {'MRR': 0.01323377073660658, 'NDCG5': 0.019212549103768895, 'NDCG10': 0.02345801419408797, 'HR1': 0.0073461891643709825, 'HR5': 0.01928374655647383, 'HR10': 0.028466483011937556, 'NUM': 1089}, 'Y': {'MRR': 0.001863841475377673, 'NDCG5': 0.003083180900114024, 'NDCG10': 0.003083180900114024, 'HR1': 0.0011771630370806356, 'HR5': 0.002942907592701589, 'HR10': 0.002942907592701589, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 2, 'joint_loss_avg': '21.2649', 'main_loss_avg': '8.8846', 'gcl_loss_avg': '12.3784', 'mmd_loss_avg': '0.0197'}
{'Epoch': 2, 'X': {'MRR': 0.015269651904719156, 'NDCG5': 0.021141675139880082, 'NDCG10': 0.024934241391629287, 'HR1': 0.010101010101010102, 'HR5': 0.01928374655647383, 'HR10': 0.027548209366391185, 'NUM': 1089}, 'Y': {'MRR': 0.003031194820482637, 'NDCG5': 0.004784974270616582, 'NDCG10': 0.005087445337343921, 'HR1': 0.002354326074161271, 'HR5': 0.004708652148322542, 'HR10': 0.00529723366686286, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 3, 'joint_loss_avg': '20.8517', 'main_loss_avg': '8.6370', 'gcl_loss_avg': '12.2121', 'mmd_loss_avg': '0.0266'}
{'Epoch': 3, 'X': {'MRR': 0.014879196098865346, 'NDCG5': 0.021228760516375397, 'NDCG10': 0.028043444548718724, 'HR1': 0.0073461891643709825, 'HR5': 0.02295684113865932, 'HR10': 0.03764921946740129, 'NUM': 1089}, 'Y': {'MRR': 0.0030900529723366685, 'NDCG5': 0.00536297781778022, 'NDCG10': 0.00566544888450756, 'HR1': 0.0011771630370806356, 'HR5': 0.005885815185403178, 'HR10': 0.006474396703943496, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 4, 'joint_loss_avg': '20.3232', 'main_loss_avg': '8.3660', 'gcl_loss_avg': '11.9548', 'mmd_loss_avg': '0.0236'}
{'Epoch': 4, 'X': {'MRR': 0.012328068694540896, 'NDCG5': 0.01784303762333217, 'NDCG10': 0.024728737450853373, 'HR1': 0.0027548209366391185, 'HR5': 0.02203856749311295, 'HR10': 0.03673094582185491, 'NUM': 1089}, 'Y': {'MRR': 0.002704205087960238, 'NDCG5': 0.004863980680369266, 'NDCG10': 0.005422069452748902, 'HR1': 0.0005885815185403178, 'HR5': 0.005885815185403178, 'HR10': 0.007062978222483814, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 5, 'joint_loss_avg': '19.7567', 'main_loss_avg': '7.8946', 'gcl_loss_avg': '11.8596', 'mmd_loss_avg': '0.0247'}
{'Epoch': 5, 'X': {'MRR': 0.017014420622020684, 'NDCG5': 0.02477939126987973, 'NDCG10': 0.03205488215095402, 'HR1': 0.0073461891643709825, 'HR5': 0.02662993572084481, 'HR10': 0.04224058769513315, 'NUM': 1089}, 'Y': {'MRR': 0.0040579425806029695, 'NDCG5': 0.007514502002306851, 'NDCG10': 0.008865976957863795, 'HR1': 0.0011771630370806356, 'HR5': 0.010005885815185403, 'HR10': 0.012948793407886992, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 6, 'joint_loss_avg': '19.3704', 'main_loss_avg': '7.5662', 'gcl_loss_avg': '11.8021', 'mmd_loss_avg': '0.0201'}
{'Epoch': 6, 'X': {'MRR': 0.012435012951541874, 'NDCG5': 0.01650016067340364, 'NDCG10': 0.025726564833103992, 'HR1': 0.004591368227731864, 'HR5': 0.01928374655647383, 'HR10': 0.03948576675849403, 'NUM': 1089}, 'Y': {'MRR': 0.004947121088969236, 'NDCG5': 0.007703152345497288, 'NDCG10': 0.00964314049458875, 'HR1': 0.002354326074161271, 'HR5': 0.00824014125956445, 'HR10': 0.012360211889346674, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 7, 'joint_loss_avg': '19.0327', 'main_loss_avg': '7.2736', 'gcl_loss_avg': '11.7570', 'mmd_loss_avg': '0.0200'}
{'Epoch': 7, 'X': {'MRR': 0.01591255557792586, 'NDCG5': 0.02186523777492802, 'NDCG10': 0.031812788742332995, 'HR1': 0.006427915518824609, 'HR5': 0.023875114784205693, 'HR10': 0.04499540863177227, 'NUM': 1089}, 'Y': {'MRR': 0.004781743010112638, 'NDCG5': 0.006875661607997314, 'NDCG10': 0.009902322615772263, 'HR1': 0.0017657445556209534, 'HR5': 0.007651559741024131, 'HR10': 0.014125956444967627, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 8, 'joint_loss_avg': '18.6905', 'main_loss_avg': '6.9830', 'gcl_loss_avg': '11.7055', 'mmd_loss_avg': '0.0200'}
{'Epoch': 8, 'X': {'MRR': 0.013987925144949936, 'NDCG5': 0.023484347967720694, 'NDCG10': 0.029971456722913733, 'HR1': 0.0027548209366391185, 'HR5': 0.030303030303030304, 'HR10': 0.0440771349862259, 'NUM': 1089}, 'Y': {'MRR': 0.00529746723095752, 'NDCG5': 0.007082917994151281, 'NDCG10': 0.010710270834170083, 'HR1': 0.002354326074161271, 'HR5': 0.007062978222483814, 'HR10': 0.014714537963507945, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 9, 'joint_loss_avg': '18.3877', 'main_loss_avg': '6.7073', 'gcl_loss_avg': '11.6788', 'mmd_loss_avg': '0.0162'}
{'Epoch': 9, 'X': {'MRR': 0.015821026354165223, 'NDCG5': 0.0236444676733962, 'NDCG10': 0.030863901264687084, 'HR1': 0.0073461891643709825, 'HR5': 0.025711662075298437, 'HR10': 0.04132231404958678, 'NUM': 1089}, 'Y': {'MRR': 0.005598764913067443, 'NDCG5': 0.008518589418826609, 'NDCG10': 0.011908985303042081, 'HR1': 0.002354326074161271, 'HR5': 0.010005885815185403, 'HR10': 0.017068864037669218, 'NUM': 1699}}
EarlyStopping counter: 2 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 10, 'joint_loss_avg': '17.9109', 'main_loss_avg': '6.2549', 'gcl_loss_avg': '11.6541', 'mmd_loss_avg': '0.0190'}
{'Epoch': 10, 'X': {'MRR': 0.018942405026508086, 'NDCG5': 0.029124224463011713, 'NDCG10': 0.03571137512366592, 'HR1': 0.008264462809917356, 'HR5': 0.031221303948576674, 'HR10': 0.04499540863177227, 'NUM': 1089}, 'Y': {'MRR': 0.0075822124380099665, 'NDCG5': 0.011702429629150355, 'NDCG10': 0.015016310168695274, 'HR1': 0.002942907592701589, 'HR5': 0.012948793407886992, 'HR10': 0.020011771630370805, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 11, 'joint_loss_avg': '17.6014', 'main_loss_avg': '5.9674', 'gcl_loss_avg': '11.6324', 'mmd_loss_avg': '0.0152'}
{'Epoch': 11, 'X': {'MRR': 0.0214398217841744, 'NDCG5': 0.03275168241553896, 'NDCG10': 0.038805138205121874, 'HR1': 0.011019283746556474, 'HR5': 0.03397612488521579, 'HR10': 0.046831955922865015, 'NUM': 1089}, 'Y': {'MRR': 0.007252653500446319, 'NDCG5': 0.011594757556474405, 'NDCG10': 0.014479749226841915, 'HR1': 0.002942907592701589, 'HR5': 0.01353737492642731, 'HR10': 0.01942319011183049, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 12, 'joint_loss_avg': '17.3847', 'main_loss_avg': '5.7687', 'gcl_loss_avg': '11.6143', 'mmd_loss_avg': '0.0167'}
{'Epoch': 12, 'X': {'MRR': 0.017805386124945352, 'NDCG5': 0.02998978318456017, 'NDCG10': 0.03552702224574662, 'HR1': 0.0073461891643709825, 'HR5': 0.03673094582185491, 'HR10': 0.048668503213957756, 'NUM': 1089}, 'Y': {'MRR': 0.0059914073892884945, 'NDCG5': 0.008356633451086799, 'NDCG10': 0.012613711167361758, 'HR1': 0.002354326074161271, 'HR5': 0.008828722778104767, 'HR10': 0.018246027074749854, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-64
{'epoch': 13, 'joint_loss_avg': '17.1648', 'main_loss_avg': '5.5601', 'gcl_loss_avg': '11.6024', 'mmd_loss_avg': '0.0226'}
{'Epoch': 13, 'X': {'MRR': 0.016882458170336956, 'NDCG5': 0.0268144081695624, 'NDCG10': 0.03375756490628963, 'HR1': 0.005509641873278237, 'HR5': 0.031221303948576674, 'HR10': 0.04591368227731864, 'NUM': 1089}, 'Y': {'MRR': 0.006315382021679843, 'NDCG5': 0.009349127013820091, 'NDCG10': 0.012341191947989195, 'HR1': 0.002942907592701589, 'HR5': 0.010005885815185403, 'HR10': 0.0164802825191289, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 14, 'joint_loss_avg': '16.9486', 'main_loss_avg': '5.3636', 'gcl_loss_avg': '11.5834', 'mmd_loss_avg': '0.0157'}
{'Epoch': 14, 'X': {'MRR': 0.021584158877547305, 'NDCG5': 0.03384260073795098, 'NDCG10': 0.03814216348970195, 'HR1': 0.011019283746556474, 'HR5': 0.03489439853076217, 'HR10': 0.0440771349862259, 'NUM': 1089}, 'Y': {'MRR': 0.007274141397154936, 'NDCG5': 0.011396048739902562, 'NDCG10': 0.013891972500204722, 'HR1': 0.002942907592701589, 'HR5': 0.012360211889346674, 'HR10': 0.017657445556209534, 'NUM': 1699}}
EarlyStopping counter: 2 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 15, 'joint_loss_avg': '16.5872', 'main_loss_avg': '5.0185', 'gcl_loss_avg': '11.5672', 'mmd_loss_avg': '0.0149'}
{'Epoch': 15, 'X': {'MRR': 0.01805638372442779, 'NDCG5': 0.0281572496156357, 'NDCG10': 0.0358136080191218, 'HR1': 0.008264462809917356, 'HR5': 0.03213957759412305, 'HR10': 0.048668503213957756, 'NUM': 1089}, 'Y': {'MRR': 0.006014260737627424, 'NDCG5': 0.008895889531918319, 'NDCG10': 0.011742034827469149, 'HR1': 0.002354326074161271, 'HR5': 0.010005885815185403, 'HR10': 0.015891701000588582, 'NUM': 1699}}
EarlyStopping counter: 3 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 16, 'joint_loss_avg': '16.3486', 'main_loss_avg': '4.7912', 'gcl_loss_avg': '11.5558', 'mmd_loss_avg': '0.0159'}
{'Epoch': 16, 'X': {'MRR': 0.018372429529454313, 'NDCG5': 0.028310256755220264, 'NDCG10': 0.03655334088021749, 'HR1': 0.008264462809917356, 'HR5': 0.03213957759412305, 'HR10': 0.049586776859504134, 'NUM': 1089}, 'Y': {'MRR': 0.005169941235273785, 'NDCG5': 0.007659386734199024, 'NDCG10': 0.010457019123669154, 'HR1': 0.0017657445556209534, 'HR5': 0.008828722778104767, 'HR10': 0.014714537963507945, 'NUM': 1699}}
EarlyStopping counter: 4 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 17, 'joint_loss_avg': '16.1575', 'main_loss_avg': '4.6112', 'gcl_loss_avg': '11.5448', 'mmd_loss_avg': '0.0140'}
{'Epoch': 17, 'X': {'MRR': 0.01693414227849489, 'NDCG5': 0.027129176663811278, 'NDCG10': 0.032653363641089096, 'HR1': 0.0073461891643709825, 'HR5': 0.030303030303030304, 'HR10': 0.04224058769513315, 'NUM': 1089}, 'Y': {'MRR': 0.0061747339704961825, 'NDCG5': 0.009162011477745547, 'NDCG10': 0.01214683186321565, 'HR1': 0.002942907592701589, 'HR5': 0.009417304296645085, 'HR10': 0.015891701000588582, 'NUM': 1699}}
EarlyStopping counter: 5 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 18, 'joint_loss_avg': '16.0051', 'main_loss_avg': '4.4692', 'gcl_loss_avg': '11.5344', 'mmd_loss_avg': '0.0159'}
{'Epoch': 18, 'X': {'MRR': 0.017154965226590567, 'NDCG5': 0.02797835992673926, 'NDCG10': 0.035018286722342584, 'HR1': 0.004591368227731864, 'HR5': 0.03397612488521579, 'HR10': 0.048668503213957756, 'NUM': 1089}, 'Y': {'MRR': 0.006965136099921268, 'NDCG5': 0.01035520847455077, 'NDCG10': 0.012919640593265114, 'HR1': 0.003531489111241907, 'HR5': 0.01059446733372572, 'HR10': 0.015891701000588582, 'NUM': 1699}}
EarlyStopping counter: 6 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 19, 'joint_loss_avg': '15.8329', 'main_loss_avg': '4.3033', 'gcl_loss_avg': '11.5282', 'mmd_loss_avg': '0.0132'}
{'Epoch': 19, 'X': {'MRR': 0.01720773614713008, 'NDCG5': 0.030484228852757034, 'NDCG10': 0.03511859217926976, 'HR1': 0.005509641873278237, 'HR5': 0.03764921946740129, 'HR10': 0.047750229568411386, 'NUM': 1089}, 'Y': {'MRR': 0.0059052010052598625, 'NDCG5': 0.008865689635168325, 'NDCG10': 0.011237560900925375, 'HR1': 0.003531489111241907, 'HR5': 0.008828722778104767, 'HR10': 0.014125956444967627, 'NUM': 1699}}
EarlyStopping counter: 7 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 20, 'joint_loss_avg': '15.5491', 'main_loss_avg': '4.0264', 'gcl_loss_avg': '11.5213', 'mmd_loss_avg': '0.0136'}
{'Epoch': 20, 'X': {'MRR': 0.020346297412413106, 'NDCG5': 0.03266056086545435, 'NDCG10': 0.03879481268753869, 'HR1': 0.009182736455463728, 'HR5': 0.03581267217630854, 'HR10': 0.048668503213957756, 'NUM': 1089}, 'Y': {'MRR': 0.006938276229035499, 'NDCG5': 0.010482998640567861, 'NDCG10': 0.01277446437863065, 'HR1': 0.004120070629782225, 'HR5': 0.01059446733372572, 'HR10': 0.015303119482048263, 'NUM': 1699}}
EarlyStopping counter: 8 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 21, 'joint_loss_avg': '15.3595', 'main_loss_avg': '3.8437', 'gcl_loss_avg': '11.5142', 'mmd_loss_avg': '0.0162'}
{'Epoch': 21, 'X': {'MRR': 0.017880507412187847, 'NDCG5': 0.030817802834082076, 'NDCG10': 0.03566363993307317, 'HR1': 0.005509641873278237, 'HR5': 0.03764921946740129, 'HR10': 0.047750229568411386, 'NUM': 1089}, 'Y': {'MRR': 0.00796454216112839, 'NDCG5': 0.01148708605708762, 'NDCG10': 0.01380173166760629, 'HR1': 0.00529723366686286, 'HR5': 0.01059446733372572, 'HR10': 0.015303119482048263, 'NUM': 1699}}
EarlyStopping counter: 9 out of 10
n_sample-[20, 20]-hidden_size-64
{'epoch': 22, 'joint_loss_avg': '15.2393', 'main_loss_avg': '3.7259', 'gcl_loss_avg': '11.5120', 'mmd_loss_avg': '0.0140'}
{'Epoch': 22, 'X': {'MRR': 0.020028204119113206, 'NDCG5': 0.032123787076030016, 'NDCG10': 0.0381996025791053, 'HR1': 0.009182736455463728, 'HR5': 0.03489439853076217, 'HR10': 0.047750229568411386, 'NUM': 1089}, 'Y': {'MRR': 0.0073932590854309515, 'NDCG5': 0.011549457711349412, 'NDCG10': 0.013459862525605229, 'HR1': 0.004708652148322542, 'HR5': 0.011771630370806356, 'HR10': 0.015891701000588582, 'NUM': 1699}}
EarlyStopping counter: 10 out of 10
Early stopping
---------------Change to test_rating_matrix!-------------------
{'Epoch': 0, 'X': {'MRR': 0.020386779905294306, 'NDCG5': 0.03224509454797001, 'NDCG10': 0.03753229079049543, 'HR1': 0.011342155009451797, 'HR5': 0.034026465028355386, 'HR10': 0.045368620037807186, 'NUM': 1058}, 'Y': {'MRR': 0.007365316602972598, 'NDCG5': 0.009763184775800996, 'NDCG10': 0.013367349420804558, 'HR1': 0.004340748779164406, 'HR5': 0.008681497558328812, 'HR10': 0.016277807921866522, 'NUM': 1843}}
GCL4SR-fk2-[20, 20]
{'Epoch': 0, 'X': {'MRR': 0.020386779905294306, 'NDCG5': 0.03224509454797001, 'NDCG10': 0.03753229079049543, 'HR1': 0.011342155009451797, 'HR5': 0.034026465028355386, 'HR10': 0.045368620037807186, 'NUM': 1058}, 'Y': {'MRR': 0.007365316602972598, 'NDCG5': 0.009763184775800996, 'NDCG10': 0.013367349420804558, 'HR1': 0.004340748779164406, 'HR5': 0.008681497558328812, 'HR10': 0.016277807921866522, 'NUM': 1843}}
