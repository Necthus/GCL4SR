Namespace(model_name='GCL4SR', data_name='fk', data_dir='./datasets/fk/', output_dir='output/', do_eval=False, no_cuda=False, gpu_id='3', lr=0.001, lr_dc=0.7, lr_dc_step=5, weight_decay=5e-05, adam_beta1=0.9, adam_beta2=0.999, num_hidden_layers=2, num_attention_heads=2, hidden_act='gelu', attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, epochs=200, batch_size=1024, max_seq_length=15, hidden_size=256, seed=2022, log_freq=1, patience=10, gnn_dropout_prob=0.5, use_renorm=True, use_scale=False, fast_run=True, sample_depth=2, sample_width=20, lam1=1, lam2=0.1, cuda_condition=True, sample_size=[20, 20], data_file='./datasets/fk/fk.txt', x_domain_size=29208, item_size=64090, user_size=16573, log_file='output/GCL4SR-fk-[20, 20].txt')
n_sample-[20, 20]-hidden_size-256
{'epoch': 0, 'joint_loss_avg': '25.5524', 'main_loss_avg': '10.3614', 'gcl_loss_avg': '15.1095', 'mmd_loss_avg': '0.8153'}
{'Epoch': 0, 'X': {'MRR': 0.0031, 'NDCG5': 0.0053, 'NDCG10': 0.0061, 'HR1': 0.0009, 'HR5': 0.0064, 'HR10': 0.0083, 'NUM': 1089}, 'Y': {'MRR': 0.0006, 'NDCG5': 0.0008, 'NDCG10': 0.0008, 'HR1': 0.0006, 'HR5': 0.0006, 'HR10': 0.0006, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-256
{'epoch': 1, 'joint_loss_avg': '23.0630', 'main_loss_avg': '9.3996', 'gcl_loss_avg': '13.6537', 'mmd_loss_avg': '0.0970'}
{'Epoch': 1, 'X': {'MRR': 0.0033, 'NDCG5': 0.0044, 'NDCG10': 0.0065, 'HR1': 0.0009, 'HR5': 0.0055, 'HR10': 0.0101, 'NUM': 1089}, 'Y': {'MRR': 0.0014, 'NDCG5': 0.0023, 'NDCG10': 0.0023, 'HR1': 0.0006, 'HR5': 0.0024, 'HR10': 0.0024, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-256
{'epoch': 2, 'joint_loss_avg': '22.4347', 'main_loss_avg': '9.1885', 'gcl_loss_avg': '13.2362', 'mmd_loss_avg': '0.1002'}
{'Epoch': 2, 'X': {'MRR': 0.0064, 'NDCG5': 0.0088, 'NDCG10': 0.0112, 'HR1': 0.0037, 'HR5': 0.0083, 'HR10': 0.0138, 'NUM': 1089}, 'Y': {'MRR': 0.0009, 'NDCG5': 0.0014, 'NDCG10': 0.0014, 'HR1': 0.0006, 'HR5': 0.0012, 'HR10': 0.0012, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-256
{'epoch': 3, 'joint_loss_avg': '21.3424', 'main_loss_avg': '8.8943', 'gcl_loss_avg': '12.4443', 'mmd_loss_avg': '0.0379'}
{'Epoch': 3, 'X': {'MRR': 0.009, 'NDCG5': 0.0112, 'NDCG10': 0.0186, 'HR1': 0.0028, 'HR5': 0.0129, 'HR10': 0.0285, 'NUM': 1089}, 'Y': {'MRR': 0.0034, 'NDCG5': 0.0051, 'NDCG10': 0.0059, 'HR1': 0.0024, 'HR5': 0.0047, 'HR10': 0.0065, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-256
{'epoch': 4, 'joint_loss_avg': '20.6387', 'main_loss_avg': '8.5651', 'gcl_loss_avg': '12.0710', 'mmd_loss_avg': '0.0255'}
{'Epoch': 4, 'X': {'MRR': 0.0141, 'NDCG5': 0.0202, 'NDCG10': 0.0267, 'HR1': 0.0055, 'HR5': 0.022, 'HR10': 0.0358, 'NUM': 1089}, 'Y': {'MRR': 0.0054, 'NDCG5': 0.0088, 'NDCG10': 0.0091, 'HR1': 0.0029, 'HR5': 0.0088, 'HR10': 0.0094, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-256
{'epoch': 5, 'joint_loss_avg': '20.0371', 'main_loss_avg': '8.1255', 'gcl_loss_avg': '11.9085', 'mmd_loss_avg': '0.0310'}
{'Epoch': 5, 'X': {'MRR': 0.0151, 'NDCG5': 0.0185, 'NDCG10': 0.0306, 'HR1': 0.0073, 'HR5': 0.0184, 'HR10': 0.0441, 'NUM': 1089}, 'Y': {'MRR': 0.0048, 'NDCG5': 0.0086, 'NDCG10': 0.0091, 'HR1': 0.0012, 'HR5': 0.01, 'HR10': 0.0112, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-256
{'epoch': 6, 'joint_loss_avg': '19.5806', 'main_loss_avg': '7.7520', 'gcl_loss_avg': '11.8253', 'mmd_loss_avg': '0.0325'}
{'Epoch': 6, 'X': {'MRR': 0.0164, 'NDCG5': 0.025, 'NDCG10': 0.0313, 'HR1': 0.0064, 'HR5': 0.0285, 'HR10': 0.0422, 'NUM': 1089}, 'Y': {'MRR': 0.006, 'NDCG5': 0.0105, 'NDCG10': 0.0116, 'HR1': 0.0024, 'HR5': 0.0124, 'HR10': 0.0147, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-256
{'epoch': 7, 'joint_loss_avg': '19.0667', 'main_loss_avg': '7.3411', 'gcl_loss_avg': '11.7223', 'mmd_loss_avg': '0.0325'}
{'Epoch': 7, 'X': {'MRR': 0.0141, 'NDCG5': 0.0207, 'NDCG10': 0.0282, 'HR1': 0.0046, 'HR5': 0.0248, 'HR10': 0.0404, 'NUM': 1089}, 'Y': {'MRR': 0.0061, 'NDCG5': 0.0101, 'NDCG10': 0.0118, 'HR1': 0.0024, 'HR5': 0.0112, 'HR10': 0.0147, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-256
{'epoch': 8, 'joint_loss_avg': '18.4504', 'main_loss_avg': '6.8409', 'gcl_loss_avg': '11.6074', 'mmd_loss_avg': '0.0216'}
{'Epoch': 8, 'X': {'MRR': 0.0184, 'NDCG5': 0.0298, 'NDCG10': 0.0357, 'HR1': 0.0064, 'HR5': 0.0349, 'HR10': 0.0478, 'NUM': 1089}, 'Y': {'MRR': 0.0048, 'NDCG5': 0.0073, 'NDCG10': 0.0095, 'HR1': 0.0024, 'HR5': 0.0082, 'HR10': 0.0129, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-256
{'epoch': 9, 'joint_loss_avg': '17.7424', 'main_loss_avg': '6.2146', 'gcl_loss_avg': '11.5258', 'mmd_loss_avg': '0.0199'}
{'Epoch': 9, 'X': {'MRR': 0.0165, 'NDCG5': 0.0268, 'NDCG10': 0.034, 'HR1': 0.0055, 'HR5': 0.0331, 'HR10': 0.0487, 'NUM': 1089}, 'Y': {'MRR': 0.0057, 'NDCG5': 0.009, 'NDCG10': 0.0115, 'HR1': 0.0024, 'HR5': 0.01, 'HR10': 0.0153, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-256
{'epoch': 10, 'joint_loss_avg': '16.9211', 'main_loss_avg': '5.4361', 'gcl_loss_avg': '11.4832', 'mmd_loss_avg': '0.0174'}
{'Epoch': 10, 'X': {'MRR': 0.0164, 'NDCG5': 0.0263, 'NDCG10': 0.0328, 'HR1': 0.0055, 'HR5': 0.0312, 'HR10': 0.045, 'NUM': 1089}, 'Y': {'MRR': 0.0073, 'NDCG5': 0.0111, 'NDCG10': 0.0135, 'HR1': 0.0041, 'HR5': 0.0112, 'HR10': 0.0165, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-256
{'epoch': 11, 'joint_loss_avg': '16.3337', 'main_loss_avg': '4.8733', 'gcl_loss_avg': '11.4587', 'mmd_loss_avg': '0.0174'}
{'Epoch': 11, 'X': {'MRR': 0.0201, 'NDCG5': 0.0328, 'NDCG10': 0.0386, 'HR1': 0.0101, 'HR5': 0.0376, 'HR10': 0.0496, 'NUM': 1089}, 'Y': {'MRR': 0.0052, 'NDCG5': 0.0075, 'NDCG10': 0.0107, 'HR1': 0.0018, 'HR5': 0.0082, 'HR10': 0.0153, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-256
{'epoch': 12, 'joint_loss_avg': '15.8303', 'main_loss_avg': '4.3863', 'gcl_loss_avg': '11.4422', 'mmd_loss_avg': '0.0176'}
{'Epoch': 12, 'X': {'MRR': 0.0196, 'NDCG5': 0.0305, 'NDCG10': 0.0378, 'HR1': 0.0073, 'HR5': 0.0349, 'HR10': 0.0505, 'NUM': 1089}, 'Y': {'MRR': 0.0061, 'NDCG5': 0.0095, 'NDCG10': 0.0112, 'HR1': 0.0024, 'HR5': 0.01, 'HR10': 0.0135, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-256
{'epoch': 13, 'joint_loss_avg': '15.3932', 'main_loss_avg': '3.9637', 'gcl_loss_avg': '11.4276', 'mmd_loss_avg': '0.0195'}
{'Epoch': 13, 'X': {'MRR': 0.0235, 'NDCG5': 0.0364, 'NDCG10': 0.0438, 'HR1': 0.0129, 'HR5': 0.0386, 'HR10': 0.0542, 'NUM': 1089}, 'Y': {'MRR': 0.0049, 'NDCG5': 0.0074, 'NDCG10': 0.0099, 'HR1': 0.0018, 'HR5': 0.0082, 'HR10': 0.0135, 'NUM': 1699}}
Validation score increased.  Saving model ...
n_sample-[20, 20]-hidden_size-256
{'epoch': 14, 'joint_loss_avg': '15.0192', 'main_loss_avg': '3.6000', 'gcl_loss_avg': '11.4175', 'mmd_loss_avg': '0.0177'}
{'Epoch': 14, 'X': {'MRR': 0.0212, 'NDCG5': 0.0327, 'NDCG10': 0.0408, 'HR1': 0.011, 'HR5': 0.0358, 'HR10': 0.0533, 'NUM': 1089}, 'Y': {'MRR': 0.006, 'NDCG5': 0.009, 'NDCG10': 0.0112, 'HR1': 0.0029, 'HR5': 0.0094, 'HR10': 0.0141, 'NUM': 1699}}
EarlyStopping counter: 1 out of 10
n_sample-[20, 20]-hidden_size-256
{'epoch': 15, 'joint_loss_avg': '14.6455', 'main_loss_avg': '3.2374', 'gcl_loss_avg': '11.4066', 'mmd_loss_avg': '0.0150'}
{'Epoch': 15, 'X': {'MRR': 0.0206, 'NDCG5': 0.0347, 'NDCG10': 0.0393, 'HR1': 0.0101, 'HR5': 0.0404, 'HR10': 0.0505, 'NUM': 1089}, 'Y': {'MRR': 0.006, 'NDCG5': 0.0091, 'NDCG10': 0.0119, 'HR1': 0.0024, 'HR5': 0.01, 'HR10': 0.0159, 'NUM': 1699}}
EarlyStopping counter: 2 out of 10
n_sample-[20, 20]-hidden_size-256
{'epoch': 16, 'joint_loss_avg': '14.3906', 'main_loss_avg': '2.9930', 'gcl_loss_avg': '11.3958', 'mmd_loss_avg': '0.0178'}
{'Epoch': 16, 'X': {'MRR': 0.0237, 'NDCG5': 0.0366, 'NDCG10': 0.0418, 'HR1': 0.0119, 'HR5': 0.0376, 'HR10': 0.0487, 'NUM': 1089}, 'Y': {'MRR': 0.0054, 'NDCG5': 0.0086, 'NDCG10': 0.0115, 'HR1': 0.0018, 'HR5': 0.01, 'HR10': 0.0165, 'NUM': 1699}}
EarlyStopping counter: 3 out of 10
n_sample-[20, 20]-hidden_size-256
{'epoch': 17, 'joint_loss_avg': '14.2228', 'main_loss_avg': '2.8274', 'gcl_loss_avg': '11.3938', 'mmd_loss_avg': '0.0169'}
{'Epoch': 17, 'X': {'MRR': 0.023, 'NDCG5': 0.0365, 'NDCG10': 0.0421, 'HR1': 0.0129, 'HR5': 0.0386, 'HR10': 0.0505, 'NUM': 1089}, 'Y': {'MRR': 0.0049, 'NDCG5': 0.0075, 'NDCG10': 0.0098, 'HR1': 0.0018, 'HR5': 0.0082, 'HR10': 0.0129, 'NUM': 1699}}
EarlyStopping counter: 4 out of 10
n_sample-[20, 20]-hidden_size-256
{'epoch': 18, 'joint_loss_avg': '14.0393', 'main_loss_avg': '2.6466', 'gcl_loss_avg': '11.3912', 'mmd_loss_avg': '0.0162'}
{'Epoch': 18, 'X': {'MRR': 0.0224, 'NDCG5': 0.0352, 'NDCG10': 0.0413, 'HR1': 0.0119, 'HR5': 0.0367, 'HR10': 0.0496, 'NUM': 1089}, 'Y': {'MRR': 0.0046, 'NDCG5': 0.0075, 'NDCG10': 0.0092, 'HR1': 0.0018, 'HR5': 0.0088, 'HR10': 0.0124, 'NUM': 1699}}
EarlyStopping counter: 5 out of 10
n_sample-[20, 20]-hidden_size-256
{'epoch': 19, 'joint_loss_avg': '13.9168', 'main_loss_avg': '2.5298', 'gcl_loss_avg': '11.3855', 'mmd_loss_avg': '0.0158'}
{'Epoch': 19, 'X': {'MRR': 0.0233, 'NDCG5': 0.0354, 'NDCG10': 0.0429, 'HR1': 0.0119, 'HR5': 0.0358, 'HR10': 0.0523, 'NUM': 1089}, 'Y': {'MRR': 0.0062, 'NDCG5': 0.0097, 'NDCG10': 0.0111, 'HR1': 0.0035, 'HR5': 0.01, 'HR10': 0.0129, 'NUM': 1699}}
EarlyStopping counter: 6 out of 10
n_sample-[20, 20]-hidden_size-256
{'epoch': 20, 'joint_loss_avg': '13.6980', 'main_loss_avg': '2.3174', 'gcl_loss_avg': '11.3790', 'mmd_loss_avg': '0.0150'}
{'Epoch': 20, 'X': {'MRR': 0.0227, 'NDCG5': 0.0361, 'NDCG10': 0.0417, 'HR1': 0.0119, 'HR5': 0.0386, 'HR10': 0.0505, 'NUM': 1089}, 'Y': {'MRR': 0.0047, 'NDCG5': 0.0066, 'NDCG10': 0.0093, 'HR1': 0.0018, 'HR5': 0.0071, 'HR10': 0.0129, 'NUM': 1699}}
EarlyStopping counter: 7 out of 10
n_sample-[20, 20]-hidden_size-256
{'epoch': 21, 'joint_loss_avg': '13.5776', 'main_loss_avg': '2.2001', 'gcl_loss_avg': '11.3761', 'mmd_loss_avg': '0.0147'}
{'Epoch': 21, 'X': {'MRR': 0.0248, 'NDCG5': 0.0389, 'NDCG10': 0.0454, 'HR1': 0.0138, 'HR5': 0.0404, 'HR10': 0.0542, 'NUM': 1089}, 'Y': {'MRR': 0.0045, 'NDCG5': 0.0067, 'NDCG10': 0.0088, 'HR1': 0.0018, 'HR5': 0.0071, 'HR10': 0.0118, 'NUM': 1699}}
EarlyStopping counter: 8 out of 10
n_sample-[20, 20]-hidden_size-256
{'epoch': 22, 'joint_loss_avg': '13.5124', 'main_loss_avg': '2.1360', 'gcl_loss_avg': '11.3747', 'mmd_loss_avg': '0.0163'}
{'Epoch': 22, 'X': {'MRR': 0.0245, 'NDCG5': 0.0382, 'NDCG10': 0.0439, 'HR1': 0.0138, 'HR5': 0.0395, 'HR10': 0.0514, 'NUM': 1089}, 'Y': {'MRR': 0.005, 'NDCG5': 0.0074, 'NDCG10': 0.0093, 'HR1': 0.0024, 'HR5': 0.0077, 'HR10': 0.0118, 'NUM': 1699}}
EarlyStopping counter: 9 out of 10
n_sample-[20, 20]-hidden_size-256
{'epoch': 23, 'joint_loss_avg': '13.4073', 'main_loss_avg': '2.0326', 'gcl_loss_avg': '11.3731', 'mmd_loss_avg': '0.0157'}
{'Epoch': 23, 'X': {'MRR': 0.0257, 'NDCG5': 0.0394, 'NDCG10': 0.0466, 'HR1': 0.0147, 'HR5': 0.0395, 'HR10': 0.0551, 'NUM': 1089}, 'Y': {'MRR': 0.0055, 'NDCG5': 0.0081, 'NDCG10': 0.01, 'HR1': 0.0035, 'HR5': 0.0082, 'HR10': 0.0124, 'NUM': 1699}}
EarlyStopping counter: 10 out of 10
Early stopping
---------------Change to test_rating_matrix!-------------------
{'Epoch': 0, 'X': {'MRR': 0.0237, 'NDCG5': 0.0359, 'NDCG10': 0.0425, 'HR1': 0.0142, 'HR5': 0.0369, 'HR10': 0.051, 'NUM': 1058}, 'Y': {'MRR': 0.01, 'NDCG5': 0.014, 'NDCG10': 0.0178, 'HR1': 0.0071, 'HR5': 0.0125, 'HR10': 0.0206, 'NUM': 1843}}
GCL4SR-fk-[20, 20]
{'Epoch': 0, 'X': {'MRR': 0.0237, 'NDCG5': 0.0359, 'NDCG10': 0.0425, 'HR1': 0.0142, 'HR5': 0.0369, 'HR10': 0.051, 'NUM': 1058}, 'Y': {'MRR': 0.01, 'NDCG5': 0.014, 'NDCG10': 0.0178, 'HR1': 0.0071, 'HR5': 0.0125, 'HR10': 0.0206, 'NUM': 1843}}
